{
  if (!(location instanceof PsiLocation))   return null;
  final Module module=context.getModule();
  if (module == null || ModuleType.get(module) != FlexModuleType.getInstance())   return null;
  mySourceElement=location.getPsiElement();
  final JSClass jsClass=getJSClass(mySourceElement);
  if (jsClass != null && isAcceptedMainClass(jsClass,module,true)) {
    final RunnerAndConfigurationSettings settings=RunManagerEx.getInstanceEx(location.getProject()).createConfiguration("",FlashRunConfigurationType.getFactory());
    final FlashRunConfiguration runConfig=(FlashRunConfiguration)settings.getConfiguration();
    final FlashRunnerParameters params=runConfig.getRunnerParameters();
    params.setModuleName(module.getName());
    final FlexIdeBuildConfiguration bc=getBCToBaseOn(module,jsClass.getQualifiedName());
    params.setBCName(bc.getName());
    if (bc.getOutputType() == OutputType.Application && jsClass.getQualifiedName().equals(bc.getMainClass())) {
      params.setOverrideMainClass(false);
    }
 else {
      params.setOverrideMainClass(true);
      params.setOverriddenMainClass(jsClass.getQualifiedName());
      params.setOverriddenOutputFileName(jsClass.getName() + ".swf");
    }
    runConfig.setName(params.suggestUniqueName(context.getRunManager().getConfigurations(FlashRunConfigurationType.getInstance())));
    return settings;
  }
  return null;
}
