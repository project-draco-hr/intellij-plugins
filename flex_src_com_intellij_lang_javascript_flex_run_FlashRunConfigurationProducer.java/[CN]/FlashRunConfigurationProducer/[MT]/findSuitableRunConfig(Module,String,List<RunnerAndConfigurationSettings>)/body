{
  final FlexBuildConfigurationManager manager=FlexBuildConfigurationManager.getInstance(module);
  RunnerAndConfigurationSettings basedOnBC=null;
  RunnerAndConfigurationSettings basedOnMainClass=null;
  RunnerAndConfigurationSettings basedOnMainClassAndActiveBC=null;
  for (  final RunnerAndConfigurationSettings runConfig : existing) {
    final FlashRunnerParameters params=((FlashRunConfiguration)runConfig.getConfiguration()).getRunnerParameters();
    if (module.getName().equals(params.getModuleName())) {
      final FlexBuildConfiguration bc=manager.findConfigurationByName(params.getBCName());
      if (bc == null)       continue;
      if (params.isOverrideMainClass()) {
        if (fqn.equals(params.getOverriddenMainClass())) {
          if (manager.getActiveConfiguration() == bc) {
            basedOnMainClassAndActiveBC=runConfig;
          }
          basedOnMainClass=runConfig;
        }
      }
 else {
        if (bc.getOutputType() == OutputType.Application && fqn.equals(bc.getMainClass())) {
          if (manager.getActiveConfiguration() == bc) {
            return runConfig;
          }
          basedOnBC=runConfig;
        }
      }
    }
  }
  return basedOnBC != null ? basedOnBC : basedOnMainClassAndActiveBC != null ? basedOnMainClassAndActiveBC : basedOnMainClass;
}
