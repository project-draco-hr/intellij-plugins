{
  boolean allEmpty=true;
  for (  ModuleOrFacetCompileCache cache : myCompileCache.values()) {
    if (!cache.moduleOrFacetToAutoGeneratedConfig.isEmpty()) {
      allEmpty=false;
      break;
    }
  }
  if (allEmpty)   return;
  if (contentsChanged && file.getFileType() == StdFileTypes.XML && !JavaScriptSupportLoader.isMxmlOrFxgFile(file)) {
    if (mySavingConfigOurselves)     return;
    for (    ModuleOrFacetCompileCache cache : myCompileCache.values()) {
      final List<Object> moduleOrFacetList=cache.moduleOrFacetToAutoGeneratedConfig.getKeysByValue(file);
      if (moduleOrFacetList != null && !moduleOrFacetList.isEmpty()) {
        cache.moduleOrFacetToAutoGeneratedConfig.remove(moduleOrFacetList.get(0));
        return;
      }
    }
  }
 else   if (!contentsChanged && (includeInCompilation(myProject,file) || isResourceFile(file,CompilerConfiguration.getInstance(myProject)))) {
    final VirtualFile contentRootForFile=ProjectRootManager.getInstance(myProject).getFileIndex().getContentRootForFile(file);
    if (contentRootForFile != null) {
      for (      ModuleOrFacetCompileCache cache : myCompileCache.values()) {
        cache.moduleOrFacetToAutoGeneratedConfig.clear();
      }
    }
  }
}
