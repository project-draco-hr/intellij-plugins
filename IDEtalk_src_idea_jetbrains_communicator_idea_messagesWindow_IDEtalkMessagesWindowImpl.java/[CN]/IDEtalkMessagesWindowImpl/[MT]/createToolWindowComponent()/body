{
  myContentFactory=ContentFactory.SERVICE.getInstance();
  TabbedPaneContentUI contentUI=new TabbedPaneContentUI(SwingConstants.TOP);
  myContentManager=myContentFactory.createContentManager(contentUI,true,myProject);
  try {
    myTabsWrapper=getWrapper(contentUI);
  }
 catch (  IllegalAccessException e) {
    throw new RuntimeException(e);
  }
  myContentManager.addContentManagerListener(new ContentManagerAdapter(){
    @Override public void selectionChanged(    ContentManagerEvent event){
      super.selectionChanged(event);
      UIUtil.invokeLater(new Runnable(){
        @Override public void run(){
          processMessagesOfVisibleTab();
        }
      }
);
    }
  }
);
  myPanel=new NonOpaquePanel(new BorderLayout());
  UIUtil.runWhenShown(myPanel,new Runnable(){
    @Override public void run(){
      showAllTabsOfUsersWithMessages();
    }
  }
);
  myPanel.add(myContentManager.getComponent());
  AnAction toolbarGroup=myActionManager.getAction("IDEtalk.MessageWindowToolbar");
  if (toolbarGroup != null) {
    ActionToolbar toolbar=myActionManager.createActionToolbar(PLACE_TOOLBAR,(ActionGroup)toolbarGroup,false);
    myPanel.add(toolbar.getComponent(),BorderLayout.WEST);
  }
}
