{
  if (!ArrayUtil.contains(bc,FlexBuildConfigurationManager.getInstance(module).getBuildConfigurations())) {
    throw new IllegalArgumentException("Build configuration '" + bc.getName() + "' does not belong to module '"+ module.getName()+ "'");
  }
  module.putUserData(FlexOrderEnumerationHandler.FORCE_BC,bc);
  try {
    return new ModuleWithDependenciesScope(module,ModuleWithDependenciesScope.COMPILE | ModuleWithDependenciesScope.MODULES | ModuleWithDependenciesScope.LIBRARIES| (includeTests ? ModuleWithDependenciesScope.TESTS : 0));
  }
  finally {
    module.putUserData(FlexOrderEnumerationHandler.FORCE_BC,null);
  }
}
