{
  if (FlexIdeUtils.isNewUI()) {
    if (ModuleType.get(module) instanceof FlexModuleType) {
      FlexIdeBuildConfiguration bc=FlexBuildConfigurationManager.getInstance(module).getActiveConfiguration();
      SdkEntry sdkEntry=bc.getDependencies().getSdkEntry();
      if (sdkEntry != null) {
        LibraryEx sdkLibrary=sdkEntry.findLibrary();
        return sdkLibrary != null ? new FlexSdkWrapper(sdkLibrary) : null;
      }
 else {
        return null;
      }
    }
 else {
      return null;
    }
  }
  if (ModuleType.get(module) instanceof FlexModuleType) {
    final Sdk sdk=ModuleRootManager.getInstance(module).getSdk();
    if (sdk != null && sdk.getSdkType() instanceof IFlexSdkType) {
      return sdk;
    }
  }
 else {
    final FlexFacet flexFacet=FacetManager.getInstance(module).getFacetByType(FlexFacet.ID);
    if (flexFacet != null) {
      return flexFacet.getConfiguration().getFlexSdk();
    }
  }
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    final Sdk sdk=ModuleRootManager.getInstance(module).getSdk();
    if (sdk != null && sdk.getSdkType() instanceof IFlexSdkType) {
      return sdk;
    }
  }
  return null;
}
