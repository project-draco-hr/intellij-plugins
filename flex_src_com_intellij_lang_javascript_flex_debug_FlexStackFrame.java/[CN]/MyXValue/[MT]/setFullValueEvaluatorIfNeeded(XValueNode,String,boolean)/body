{
  final String fullValue=value;
  final int lfIndex=fullValue.indexOf('\n');
  final int crIndex=fullValue.indexOf('\r');
  if (fullValue.length() > MAX_STRING_LENGTH_TO_SHOW || lfIndex > -1 && lfIndex < fullValue.length() - 1 || crIndex > -1 && crIndex < fullValue.length() - 1) {
    final boolean quoted=fullValue.charAt(0) == '\'' && fullValue.charAt(fullValue.length() - 1) == '\'';
    final boolean doubleQuoted=fullValue.charAt(0) == '\"' && fullValue.charAt(fullValue.length() - 1) == '\"';
    if (value.length() > MAX_STRING_LENGTH_TO_SHOW) {
      final String ending=doubleQuoted ? "\" " : quoted ? "\' " : " ";
      value=value.substring(0,MAX_STRING_LENGTH_TO_SHOW).concat("...").concat(ending);
    }
 else     if (!value.endsWith(" ")) {
      value=value.concat(" ");
    }
    final String unquoted=quoted || doubleQuoted ? fullValue.substring(1,fullValue.length() - 1) : fullValue;
    node.setFullValueEvaluator(new XFullValueEvaluator(FlexBundle.message("debugger.show.full.value")){
      public void startEvaluation(      @NotNull XFullValueEvaluationCallback callback){
        callback.evaluated(unquoted,isXml ? XmlObjectEvaluator.MONOSPACED_FONT : null);
      }
    }
);
  }
  return value;
}
