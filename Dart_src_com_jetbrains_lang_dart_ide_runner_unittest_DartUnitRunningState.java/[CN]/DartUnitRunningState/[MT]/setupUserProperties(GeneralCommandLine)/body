{
  commandLine.addParameter("--ignore-unrecognized-flags");
  StringTokenizer argumentsTokenizer=new StringTokenizer(StringUtil.notNullize(myUnitParameters.getVMOptions()));
  while (argumentsTokenizer.hasMoreTokens()) {
    commandLine.addParameter(argumentsTokenizer.nextToken());
  }
  final VirtualFile file=LocalFileSystem.getInstance().findFileByPath(myUnitParameters.getFilePath());
  if (file != null) {
    final VirtualFile[] packageRoots=DartUrlResolver.getInstance(getEnvironment().getProject(),file).getPackageRoots();
    if (packageRoots.length > 0) {
      commandLine.addParameter("--package-root=" + packageRoots[0].getPath());
    }
  }
  if (myDebuggingPort > 0) {
    commandLine.addParameter("--debug:" + myDebuggingPort);
  }
  try {
    commandLine.addParameter(createPatchedFile());
  }
 catch (  IOException e) {
    LOG.debug(e);
    throw new ExecutionException("Can't create runner!");
  }
  argumentsTokenizer=new StringTokenizer(StringUtil.notNullize(myUnitParameters.getArguments()));
  while (argumentsTokenizer.hasMoreTokens()) {
    commandLine.addParameter(argumentsTokenizer.nextToken());
  }
}
