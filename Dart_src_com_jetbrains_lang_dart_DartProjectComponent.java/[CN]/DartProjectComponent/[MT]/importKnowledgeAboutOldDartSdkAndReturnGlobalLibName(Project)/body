{
  final String oldDartSdkPath=PropertiesComponent.getInstance().getValue("dart_sdk_path");
  PropertiesComponent.getInstance().unsetValue("dart_sdk_path");
  final DartSdk sdk=DartSdk.getGlobalDartSdk();
  if (sdk != null) {
    return sdk.getGlobalLibName();
  }
 else   if (DartSdkUtil.isDartSdkHome(oldDartSdkPath)) {
    if (DartiumUtil.getDartiumBrowser() == null) {
      final WebBrowser browser=DartiumUtil.ensureDartiumBrowserConfigured(DartiumUtil.getDartiumPathForSdk(oldDartSdkPath));
      final BrowserSpecificSettings browserSpecificSettings=browser.getSpecificSettings();
      if (browserSpecificSettings instanceof ChromeSettings) {
        DartiumUtil.setCheckedMode(browserSpecificSettings.getEnvironmentVariables(),true);
      }
    }
    return ApplicationManager.getApplication().runWriteAction(new Computable<String>(){
      public String compute(){
        return DartSdkGlobalLibUtil.createDartSdkGlobalLib(project,oldDartSdkPath);
      }
    }
);
  }
  return null;
}
