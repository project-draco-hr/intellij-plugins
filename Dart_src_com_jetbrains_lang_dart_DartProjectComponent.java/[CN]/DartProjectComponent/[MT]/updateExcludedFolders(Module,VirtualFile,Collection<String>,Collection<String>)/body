{
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      final ModifiableRootModel modifiableModel=ModuleRootManager.getInstance(module).getModifiableModel();
      try {
        for (        final ContentEntry contentEntry : modifiableModel.getContentEntries()) {
          if (contentEntry.getFile() == contentRoot) {
            for (            String url : urlsToUnexclude) {
              contentEntry.removeExcludeFolder(url);
            }
            for (            String url : urlsToExclude) {
              contentEntry.addExcludeFolder(url);
            }
            break;
          }
        }
        modifiableModel.commit();
      }
 catch (      Exception e) {
        modifiableModel.dispose();
      }
    }
  }
);
}
