{
  final FlexBuildConfiguration config=FlexBuildConfiguration.getInstance(module);
  if (mySdk != null && (mySdk.getSdkType() instanceof AirMobileSdkType || mySdk.getSdkType() instanceof AirSdkType)) {
    final IFlexSdkType.Subtype subtype=((IFlexSdkType)mySdk.getSdkType()).getSubtype();
    final RunManagerEx runManager=RunManagerEx.getInstanceEx(module.getProject());
    final CompilerModuleExtension moduleExtension=CompilerModuleExtension.getInstance(module);
    final String outputDirPath=moduleExtension == null ? "" : VfsUtil.urlToPath(moduleExtension.getCompilerOutputUrl());
    final RunnerAndConfigurationSettings settings=runManager.createConfiguration("",subtype == IFlexSdkType.Subtype.AIRMobile ? AirMobileRunConfigurationType.getFactory() : AirRunConfigurationType.getFactory());
    settings.setTemporary(false);
    runManager.addConfiguration(settings,false);
    runManager.setSelectedConfiguration(settings);
    final AirRunConfiguration runConfiguration=(AirRunConfiguration)settings.getConfiguration();
    final AirRunnerParameters runnerParameters=runConfiguration.getRunnerParameters();
    runnerParameters.setModuleName(module.getName());
    if (myCreateAirDescriptor) {
      if (runnerParameters instanceof AirMobileRunnerParameters) {
        final AirMobileRunnerParameters mobileParams=(AirMobileRunnerParameters)runnerParameters;
        mobileParams.setAirMobileRunMode(AirMobileRunnerParameters.AirMobileRunMode.AppDescriptor);
        mobileParams.setMobilePackageFileName(FileUtil.getNameWithoutExtension(config.OUTPUT_FILE_NAME) + ".apk");
      }
 else {
        runnerParameters.setAirRunMode(AirRunnerParameters.AirRunMode.AppDescriptor);
      }
      runnerParameters.setAirDescriptorPath(sourceRoot.getPath() + "/" + myAirDescriptorFileName);
      runnerParameters.setAirRootDirPath(outputDirPath);
    }
 else {
      if (runnerParameters instanceof AirMobileRunnerParameters) {
        final AirMobileRunnerParameters mobileParams=(AirMobileRunnerParameters)runnerParameters;
        mobileParams.setAirMobileRunMode(AirMobileRunnerParameters.AirMobileRunMode.MainClass);
        mobileParams.setMobilePackageFileName(StringUtil.getShortName(config.MAIN_CLASS) + ".apk");
      }
 else {
        runnerParameters.setAirRunMode(AirRunnerParameters.AirRunMode.MainClass);
      }
      runnerParameters.setMainClassName(config.MAIN_CLASS);
    }
    settings.setName(runConfiguration.suggestedName());
  }
 else {
    createFlexRunConfiguration(module,config.OUTPUT_FILE_NAME);
  }
}
