{
  Project res=null;
  if (component != null) {
    res=(Project)getData(component,DataConstants.PROJECT);
  }
 else {
    IdeFrame[] frames=WindowManagerEx.getInstanceEx().getAllFrames();
    for (    IdeFrame frame : frames) {
      if (frame.isActive()) {
        res=frame.getProject();
        if (res != null)         break;
      }
    }
  }
  if (res == null) {
    Project[] openProjects=ProjectManager.getInstance().getOpenProjects();
    res=openProjects.length > 0 ? openProjects[0] : null;
  }
  return res;
}
