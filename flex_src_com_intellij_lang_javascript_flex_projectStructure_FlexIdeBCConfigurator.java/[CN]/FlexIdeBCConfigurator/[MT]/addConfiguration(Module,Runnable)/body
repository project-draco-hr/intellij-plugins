{
  if (module == null) {
    return;
  }
  Pair<String,BuildConfigurationNature> nameAndNature=promptForCreation(module,FlexBundle.message("add.build.configuration.title",module.getName()),BuildConfigurationNature.DEFAULT);
  if (nameAndNature == null) {
    return;
  }
  final ModifiableFlexIdeBuildConfiguration bc=myConfigEditor.createConfiguration(module);
  final String bcName=nameAndNature.first;
  final String fileName=PathUtil.suggestFileName(bcName);
  final BuildConfigurationNature nature=nameAndNature.second;
  bc.setName(bcName);
  bc.setNature(nature);
  final ModifiableFlexIdeBuildConfiguration someExistingConfig=myConfigEditor.getConfigurations(module)[0];
  final FlexIdeBCConfigurable configurable=FlexIdeBCConfigurable.unwrap(myConfigurablesMap.get(someExistingConfig));
  try {
    configurable.apply();
  }
 catch (  ConfigurationException ignored) {
  }
  bc.setOutputFileName(fileName + (bc.getOutputType() == OutputType.Library ? ".swc" : ".swf"));
  bc.setOutputFolder(someExistingConfig.getOutputFolder());
  if (nature.isApp()) {
    if (nature.isDesktopPlatform()) {
      bc.getAirDesktopPackagingOptions().setPackageFileName(fileName);
    }
 else     if (nature.isMobilePlatform()) {
      bc.getAndroidPackagingOptions().setPackageFileName(fileName);
      bc.getIosPackagingOptions().setPackageFileName(fileName);
    }
  }
  final SdkEntry sdkEntry=someExistingConfig.getDependencies().getSdkEntry();
  final SdkEntry newSdkEntry=sdkEntry == null ? findAnySdk() : Factory.createSdkEntry(sdkEntry.getName());
  bc.getDependencies().setSdkEntry(newSdkEntry);
  createConfigurableNode(bc,module,treeNodeNameUpdater);
}
