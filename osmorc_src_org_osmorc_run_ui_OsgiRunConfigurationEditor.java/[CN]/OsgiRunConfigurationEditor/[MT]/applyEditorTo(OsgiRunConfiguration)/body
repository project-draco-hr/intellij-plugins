{
  List<SelectedBundle> modules=getBundlesToRun();
  osgiRunConfiguration.setBundlesToDeploy(modules);
  osgiRunConfiguration.setVmParameters(vmParams.getText());
  osgiRunConfiguration.setProgramParameters(programParameters.getText());
  osgiRunConfiguration.setIncludeAllBundlesInClassPath(includeAllBundlesInClassPath.isSelected());
  osgiRunConfiguration.setWorkingDir(workingDirField.getText().replace('\\','/'));
  osgiRunConfiguration.setUseAlternativeJre(alternativeJREPanel.isPathEnabled());
  osgiRunConfiguration.setAlternativeJrePath(alternativeJREPanel.getPath());
  osgiRunConfiguration.setFrameworkStartLevel((Integer)myFrameworkStartLevel.getValue());
  osgiRunConfiguration.setDefaultStartLevel((Integer)myDefaultStartLevel.getValue());
  osgiRunConfiguration.setGenerateWorkingDir(osmorcControlledRadioButton.isSelected());
  FrameworkInstanceDefinition frameworkInstanceDefinition=(FrameworkInstanceDefinition)frameworkInstances.getSelectedItem();
  if (frameworkInstanceDefinition != null) {
    osgiRunConfiguration.setInstanceToUse(frameworkInstanceDefinition);
  }
  if (currentFrameworkRunPropertiesEditor != null) {
    currentFrameworkRunPropertiesEditor.applyEditorTo(osgiRunConfiguration);
  }
}
