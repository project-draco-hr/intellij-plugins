{
  List<SelectedBundle> modules=getBundlesToRun();
  osgiRunConfiguration.setBundlesToDeploy(modules);
  osgiRunConfiguration.setVmParameters(myVmOptions.getText());
  osgiRunConfiguration.setProgramParameters(myProgramParameters.getText());
  osgiRunConfiguration.setIncludeAllBundlesInClassPath(myClassPathAllBundles.isSelected());
  osgiRunConfiguration.setWorkingDir(myWorkingDirField.getText().replace('\\','/'));
  osgiRunConfiguration.setUseAlternativeJre(myAlternativeJrePanel.isPathEnabled());
  osgiRunConfiguration.setAlternativeJrePath(myAlternativeJrePanel.getPath());
  osgiRunConfiguration.setFrameworkStartLevel((Integer)myFrameworkStartLevel.getValue());
  osgiRunConfiguration.setDefaultStartLevel((Integer)myDefaultStartLevel.getValue());
  osgiRunConfiguration.setGenerateWorkingDir(myOsmorcControlledDir.isSelected());
  FrameworkInstanceDefinition frameworkInstanceDefinition=(FrameworkInstanceDefinition)myFrameworkInstances.getSelectedItem();
  if (frameworkInstanceDefinition != null) {
    osgiRunConfiguration.setInstanceToUse(frameworkInstanceDefinition);
  }
  if (myCurrentRunPropertiesEditor != null) {
    myCurrentRunPropertiesEditor.applyEditorTo(osgiRunConfiguration);
  }
}
