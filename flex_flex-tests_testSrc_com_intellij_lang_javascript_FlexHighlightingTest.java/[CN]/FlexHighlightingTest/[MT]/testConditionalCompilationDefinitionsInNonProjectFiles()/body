{
  final String testName=getTestName(false);
  final VirtualFile file=LocalFileSystem.getInstance().findFileByPath(getTestDataPath() + "/" + getBasePath()+ "/"+ testName+ ".as");
  final File toDirIO=createTempDirectory();
  final VirtualFile toDir=getVirtualFile(toDirIO);
  VirtualFile copyRef;
  final AccessToken accessToken=WriteAction.start();
  try {
    copyRef=file.copy(this,toDir,file.getName());
  }
  finally {
    accessToken.finish();
  }
  setActiveEditor(createEditor(copyRef));
  doDoTest(true,false,true);
}
