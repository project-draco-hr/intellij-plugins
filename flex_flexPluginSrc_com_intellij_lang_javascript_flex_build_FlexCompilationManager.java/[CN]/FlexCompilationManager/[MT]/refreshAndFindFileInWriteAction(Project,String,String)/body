{
  final LocalFileSystem localFileSystem=LocalFileSystem.getInstance();
  final Application application=ApplicationManager.getApplication();
  final Ref<VirtualFile> outputFileRef=new Ref<VirtualFile>();
  application.invokeAndWait(new Runnable(){
    public void run(){
      outputFileRef.set(application.runWriteAction(new NullableComputable<VirtualFile>(){
        public VirtualFile compute(){
          VirtualFile outputFile=localFileSystem.refreshAndFindFileByPath(outputFilePath);
          if (outputFile == null) {
            for (            final String baseDir : possibleBaseDirs) {
              outputFile=localFileSystem.refreshAndFindFileByPath(baseDir + "/" + outputFilePath);
              if (outputFile != null) {
                break;
              }
            }
          }
          if (outputFile == null)           return null;
          outputFile.refresh(false,false);
          return outputFile;
        }
      }
));
    }
  }
,ModalityState.defaultModalityState());
  return outputFileRef.get();
}
