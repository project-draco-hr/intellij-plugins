{
  myProject=project;
  myFrameworkInstance.setRenderer(new OsgiUiUtil.FrameworkInstanceRenderer("[not specified]"){
    @Override protected boolean isInstanceDefined(    @NotNull FrameworkInstanceDefinition instance){
      List<FrameworkInstanceDefinition> instanceDefinitions=ApplicationSettings.getInstance().getActiveFrameworkInstanceDefinitions();
      for (      FrameworkInstanceDefinition instanceDefinition : instanceDefinitions) {
        if (instance.equals(instanceDefinition)) {
          return true;
        }
      }
      return false;
    }
  }
);
  myWatcher=new UserActivityWatcher();
  myWatcher.register(myMainPanel);
  myWatcher.addUserActivityListener(new UserActivityListener(){
    public void stateChanged(){
      myModified=true;
    }
  }
);
  myDefaultManifestFileLocation.setEditable(true);
  myDefaultManifestFileLocation.addItem("META-INF");
  myBundleOutputPath.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      VirtualFile preselect=LocalFileSystem.getInstance().findFileByPath(myBundleOutputPath.getText());
      if (preselect == null)       preselect=myProject.getBaseDir();
      VirtualFile virtualFile=FileChooser.chooseFile(FileChooserDescriptorFactory.createSingleFolderDescriptor(),myProject,preselect);
      if (virtualFile != null) {
        myBundleOutputPath.setText(virtualFile.getPath());
      }
    }
  }
);
  myApplyToAllButton.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        @Override public void run(){
          for (          Module module : ModuleManager.getInstance(myProject).getModules()) {
            OsmorcFacet facet=OsmorcFacet.getInstance(module);
            if (facet != null) {
              OsmorcFacetConfiguration configuration=facet.getConfiguration();
              configuration.setJarFileLocation(configuration.getJarFileName(),OsmorcFacetConfiguration.OutputPathType.OsgiOutputPath);
            }
          }
        }
      }
);
      String message="The output path has been applied to all OSGi facets in the current project.";
      Messages.showInfoMessage(myProject,message,"Output Path Applied");
    }
  }
);
}
