{
  if (ApplicationManager.getApplication().isReadAccessAllowed()) {
    LOG.error("DartProjectTemplate.loadTemplatesAsync() must be called in pooled thread without read action");
  }
  final List<DartProjectTemplate> templates=new ArrayList<DartProjectTemplate>();
  try {
    templates.addAll(getStagehandTemplates());
  }
  finally {
    if (templates.isEmpty()) {
      templates.add(new WebAppTemplate());
      templates.add(new CmdLineAppTemplate());
    }
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      @Override public void run(){
        templatesConsumer.consume(templates);
      }
    }
,ModalityState.any());
  }
}
