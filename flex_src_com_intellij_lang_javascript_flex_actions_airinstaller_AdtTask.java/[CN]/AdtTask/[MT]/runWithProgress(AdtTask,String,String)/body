{
  final Runnable process=new Runnable(){
    public void run(){
      final ProgressIndicator indicator=ProgressManager.getInstance().getProgressIndicator();
      if (indicator != null) {
        indicator.setIndeterminate(true);
      }
      task.start();
      while (!task.isFinished()) {
        if (indicator != null && indicator.isCanceled()) {
          task.cancel();
          break;
        }
        try {
          Thread.sleep(200);
        }
 catch (        InterruptedException e) {
        }
      }
    }
  }
;
  final boolean ok=ProgressManager.getInstance().runProcessWithProgressSynchronously(process,progressTitle,true,task.myProject);
  if (ok) {
    final List<String> messages=task.getMessages();
    if (task.checkMessages(messages)) {
      return true;
    }
 else {
      final String message=messages.isEmpty() ? FlexBundle.message("unexpected.empty.adt.output") : StringUtil.join(messages,"\n");
      Messages.showErrorDialog(task.myProject,message,frameTitle);
    }
  }
  return false;
}
