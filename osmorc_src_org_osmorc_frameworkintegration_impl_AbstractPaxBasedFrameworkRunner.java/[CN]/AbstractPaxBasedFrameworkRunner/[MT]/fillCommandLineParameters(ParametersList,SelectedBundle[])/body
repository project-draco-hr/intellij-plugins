{
  commandLineParameters.add("--p=" + getOsgiFrameworkName().toLowerCase());
  commandLineParameters.add("--nologo=true");
  FrameworkInstanceDefinition definition=getRunConfiguration().getInstanceToUse();
  String version=null;
  if (definition != null) {
    version=definition.getVersion();
  }
  if (!StringUtil.isEmptyOrSpaces(version)) {
    commandLineParameters.add("--v=" + version);
  }
  for (  SelectedBundle bundle : bundlesToInstall) {
    String bundleUrl=bundle.getBundleUrl();
    String prefix=CachingBundleInfoProvider.isExploded(bundleUrl) ? "scan-bundle:" : "";
    if (bundle.isStartAfterInstallation() && !CachingBundleInfoProvider.isFragmentBundle(bundleUrl)) {
      int bundleStartLevel=bundle.isDefaultStartLevel() ? getRunConfiguration().getDefaultStartLevel() : bundle.getStartLevel();
      commandLineParameters.add(prefix + bundleUrl + "@"+ bundleStartLevel);
    }
 else {
      if (CachingBundleInfoProvider.isFragmentBundle(bundleUrl)) {
        commandLineParameters.add(prefix + bundleUrl + "@nostart");
      }
 else {
        commandLineParameters.add(prefix + bundleUrl);
      }
    }
  }
  P frameworkProperties=getFrameworkProperties();
  String bootDelegation=frameworkProperties.getBootDelegation();
  if (bootDelegation != null && !(bootDelegation.trim().length() == 0)) {
    commandLineParameters.add("--bd=" + bootDelegation);
  }
  String systemPackages=frameworkProperties.getSystemPackages();
  if (systemPackages != null && !(systemPackages.trim().length() == 0)) {
    commandLineParameters.add("--sp=" + systemPackages);
  }
  int startLevel=getFrameworkStartLevel(bundlesToInstall);
  commandLineParameters.add("--sl=" + startLevel);
  int defaultStartLevel=getRunConfiguration().getDefaultStartLevel();
  commandLineParameters.add("--bsl=" + defaultStartLevel);
  if (frameworkProperties.isDebugMode()) {
    commandLineParameters.add("--log=DEBUG");
  }
  if (frameworkProperties.isStartConsole()) {
    commandLineParameters.add("--console");
  }
 else {
    commandLineParameters.add("--noConsole");
  }
  commandLineParameters.add("--executor=inProcess");
  commandLineParameters.add("--keepOriginalUrls");
  commandLineParameters.add("--skipInvalidBundles");
  String additionalProgramParams=getRunConfiguration().getProgramParameters();
  if (!StringUtil.isEmptyOrSpaces(additionalProgramParams)) {
    commandLineParameters.addParametersString(additionalProgramParams);
  }
}
