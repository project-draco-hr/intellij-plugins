{
  super(project,true);
  myEditor=editor;
  myRefactoring=refactoring;
  myRefactoring.setListener(new ServerRefactoring.ServerRefactoringListener(){
    @Override public void requestStateChanged(    final boolean hasPendingRequests,    @NotNull final RefactoringStatus optionsStatus){
      final Runnable runnable=new Runnable(){
        @Override public void run(){
          myHasPendingRequests=hasPendingRequests;
          myOptionsStatus=optionsStatus;
          validateButtons();
        }
      }
;
      final ModalityState modalityState=ModalityState.stateForComponent(getWindow());
      final Condition expired=new Condition(){
        @Override public boolean value(        Object o){
          return !isShowing();
        }
      }
;
      ApplicationManager.getApplication().invokeLater(runnable,modalityState,expired);
    }
  }
);
}
