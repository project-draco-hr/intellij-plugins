{
  return ApplicationManager.getApplication().runReadAction(new Computable<ProcessingItem[]>(){
    public ProcessingItem[] compute(){
      CompileScope compilescope=compileContext.getCompileScope();
      Module[] affectedModules=compilescope.getAffectedModules();
      if (affectedModules.length == 0) {
        return ProcessingItem.EMPTY_ARRAY;
      }
      List<ProcessingItem> result=new ArrayList<ProcessingItem>();
      for (      Module affectedModule : affectedModules) {
        if (OsmorcFacet.hasOsmorcFacet(affectedModule)) {
          result.add(new BundleProcessingItem(affectedModule));
        }
      }
      return result.toArray(new ProcessingItem[result.size()]);
    }
  }
);
}
