{
  ApplicationManager.getApplication().executeOnPooledThread(new Runnable(){
    @Override public void run(){
      indicator.setText(FlexUIDesignerBundle.message("delete.old.libraries"));
      LibraryManager.getInstance().garbageCollection(APP_DIR);
      checkCanceled();
      try {
        if (!StringRegistry.getInstance().isEmpty()) {
          Client.getInstance().initStringRegistry();
        }
        indicator.setText(FlexUIDesignerBundle.message("collect.libraries"));
        LibraryManager.getInstance().initLibrarySets(module,APP_DIR);
      }
 catch (      IOException e) {
        LOG.error(e);
        cancel();
        return;
      }
catch (      InitException e) {
        LOG.error(e.getCause());
        notifyUser(debug,e.getMessage(),module);
        return;
      }
      libraryAndModuleInitialized=true;
      checkCanceled();
      if (clientOpened) {
        openDocument();
      }
 else       if (adlExitCode != -1) {
        cancel();
      }
    }
  }
);
}
