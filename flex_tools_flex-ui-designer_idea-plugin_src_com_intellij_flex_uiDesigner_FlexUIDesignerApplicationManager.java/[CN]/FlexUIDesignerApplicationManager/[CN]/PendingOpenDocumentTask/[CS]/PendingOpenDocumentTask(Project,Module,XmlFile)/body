{
  myProject=project;
  myModule=module;
  myPsiFile=psiFile;
  ApplicationManager.getApplication().executeOnPooledThread(new Runnable(){
    @Override public void run(){
      try {
        if (!ServiceManager.getService(StringRegistry.class).isEmpty()) {
          Client.getInstance().initStringRegistry();
        }
        LibraryManager.getInstance().initLibrarySets(myModule,appDir);
      }
 catch (      IOException e) {
        try {
          server.close();
        }
 catch (        IOException innerError) {
          LOG.error(innerError);
        }
 finally {
          serverClosed();
        }
        LOG.error(e);
      }
catch (      InitException e) {
        LOG.error(e.getCause());
        DocumentProblemManager.getInstance().reportWithTitle(myProject,e.getMessage());
      }
      libraryAndModuleInitialized=true;
      if (clientOpened) {
        openDocument();
      }
    }
  }
);
}
