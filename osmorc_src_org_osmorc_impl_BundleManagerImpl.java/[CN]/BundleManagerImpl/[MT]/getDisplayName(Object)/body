{
  if (bundle instanceof Module) {
    return ((Module)bundle).getName();
  }
  if (bundle instanceof Library) {
    final String libName=((Library)bundle).getName();
    if (libName == null) {
      final VirtualFile[] files=((Library)bundle).getFiles(OrderRootType.CLASSES);
      if (files.length > 0) {
        final VirtualFile file=files[0];
        if (file != null) {
          return file.getName();
        }
      }
      return "unnamed library";
    }
 else {
      return libName;
    }
  }
  return bundle.toString();
}
