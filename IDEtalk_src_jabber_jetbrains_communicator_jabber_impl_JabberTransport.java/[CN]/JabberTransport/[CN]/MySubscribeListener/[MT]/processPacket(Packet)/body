{
  final Presence presence=((Presence)packet);
  if (presence.getType() != Presence.Type.subscribe)   return;
  LOG.info("Subscribe request from " + presence.getFrom());
  if (myIgnoreList.isIgnored(presence.getFrom())) {
    LOG.info(presence.getFrom() + " in ignore list");
    return;
  }
  if (isUserInMyContactListAndActive(presence.getFrom()) || Pico.isUnitTest()) {
    acceptSubscription(presence,true);
    return;
  }
  UIUtil.invokeLater(new Runnable(){
    @Override public void run(){
      acceptSubscription(presence,myUI.shouldAcceptSubscriptionRequest(presence));
    }
  }
);
}
