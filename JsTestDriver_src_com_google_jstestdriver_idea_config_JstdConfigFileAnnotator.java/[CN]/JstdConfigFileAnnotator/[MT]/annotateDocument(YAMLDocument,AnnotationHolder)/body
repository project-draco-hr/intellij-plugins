{
  List<Group> groups=buildGroups(yamlDocument);
  if (groups == null) {
    return;
  }
  VirtualFile basePath=JstdConfigFileUtils.extractBasePath(yamlDocument);
  final Set<String> visitedKeys=Sets.newHashSet();
  for (  Group group : groups) {
    YAMLKeyValue keyValue=group.getKeyValue();
    if (keyValue != null) {
      PsiElement keyElement=keyValue.getKey();
      String keyStr=keyValue.getKeyText();
      if (!JstdConfigFileUtils.isTopLevelKey(keyValue)) {
        holder.createErrorAnnotation(keyElement,"Unexpected key '" + keyStr + "'");
      }
      if (!visitedKeys.add(keyStr)) {
        holder.createErrorAnnotation(keyElement,"Duplicated '" + keyStr + "' key");
      }
      if (JstdConfigFileUtils.isBasePathKey(keyValue)) {
        annotateBasePath(yamlDocument,keyValue,holder);
      }
 else       if (JstdConfigFileUtils.isKeyWithInnerFileSequence(keyValue)) {
        annotateKeyValueWithInnerFileSequence(keyValue,holder,basePath);
      }
    }
 else {
      PsiElement element=group.getUnexpectedElement();
      if (element instanceof ASTNode) {
        ASTNode astNode=(ASTNode)element;
        if (astNode.getElementType() != YAMLTokenTypes.EOL && astNode.getElementType() != YAMLTokenTypes.INDENT) {
          holder.createErrorAnnotation(astNode,"Unexpected element '" + astNode.getText() + "'");
        }
      }
 else {
        holder.createErrorAnnotation(element,"Unexpected element '" + element.getText() + "'");
      }
    }
  }
}
