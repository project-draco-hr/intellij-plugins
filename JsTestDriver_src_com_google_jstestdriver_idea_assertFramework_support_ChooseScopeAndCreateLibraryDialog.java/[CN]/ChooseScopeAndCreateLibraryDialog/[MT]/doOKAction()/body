{
  final Ref<ErrorMessage> errorMessageRef=Ref.create();
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      DumbService.allowStartingDumbModeInside(DumbModePermission.MAY_START_BACKGROUND,new Runnable(){
        @Override public void run(){
          errorMessageRef.set(createLibraryAndAssociate());
        }
      }
);
    }
  }
);
  ErrorMessage errorMessage=errorMessageRef.get();
  if (errorMessage != null) {
    Messages.showErrorDialog(errorMessage.getDescription(),"Adding " + myLibraryHelper.getJsLibraryName());
    LOG.warn(errorMessage.getDescription(),errorMessage.getThrowable());
  }
  super.doOKAction();
}
