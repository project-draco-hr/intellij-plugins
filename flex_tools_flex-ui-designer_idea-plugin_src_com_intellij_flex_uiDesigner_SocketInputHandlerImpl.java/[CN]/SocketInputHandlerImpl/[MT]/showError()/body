{
  messageBus.syncPublisher(MESSAGE_TOPIC).errorOccured();
  String userMessage=reader.readUTF();
  final String technicalMessage=reader.readUTF();
  final VirtualFile file;
  if (reader.readBoolean()) {
    Project project=readProject();
    file=DocumentFactoryManager.getInstance(project).getFile(reader.readUnsignedShort());
  }
 else {
    file=null;
  }
  if (StringUtil.isEmpty(userMessage)) {
    userMessage=technicalMessage;
  }
  LOG.error(LogMessageUtil.createEvent(userMessage,technicalMessage,file));
}
