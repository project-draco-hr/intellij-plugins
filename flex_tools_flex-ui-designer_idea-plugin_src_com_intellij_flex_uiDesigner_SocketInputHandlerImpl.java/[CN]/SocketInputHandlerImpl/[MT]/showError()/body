{
  String userMessage=reader.readUTF();
  final String technicalMessage=reader.readUTF();
  final String title;
  final Attachment attachment;
  if (reader.readBoolean()) {
    Project project=readProject();
    final VirtualFile file=DocumentFactoryManager.getInstance(project).getFile(reader.readUnsignedShort());
    attachment=new Attachment(file.getPresentableUrl(),LoadTextUtil.loadText(file).toString());
    title=FlexUIDesignerBundle.message("problem.opening.mxml.document.0",file.getName());
  }
 else {
    title=FlexUIDesignerBundle.message("problem.opening.mxml.document");
    attachment=null;
  }
  if (StringUtil.isEmpty(userMessage)) {
    userMessage=technicalMessage;
  }
  LOG.error(LogMessageEx.createEvent(userMessage,technicalMessage,title,FlexUIDesignerBundle.message("problem.opening.mxml.document.balloon.text"),attachment));
}
