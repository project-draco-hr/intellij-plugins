{
  for (  SourceEdit edit : edits) {
    if (excludedIds.contains(edit.getId())) {
      continue;
    }
    final int offset=edit.getOffset();
    final int length=edit.getLength();
    if (length != edit.getReplacement().length() || !edit.getReplacement().equals(document.getText(TextRange.create(offset,offset + length)))) {
      document.replaceString(offset,offset + length,edit.getReplacement());
    }
  }
}
