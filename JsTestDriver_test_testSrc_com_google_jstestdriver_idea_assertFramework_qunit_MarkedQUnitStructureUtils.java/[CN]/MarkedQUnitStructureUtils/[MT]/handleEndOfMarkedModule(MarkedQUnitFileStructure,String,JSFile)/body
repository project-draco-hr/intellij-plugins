{
  Matcher moduleEndMatcher=MODULE_END_PATTERN.matcher(fileText);
  while (moduleEndMatcher.find()) {
    Annotation endAnnotation=new Annotation("moduleEnd",moduleEndMatcher.start(),moduleEndMatcher.end(),moduleEndMatcher.group(1));
    int moduleId=MarkedQUnitModuleStructure.getId(endAnnotation);
    MarkedQUnitModuleStructure markedQUnitModuleStructure=markedQUnitFileStructure.findById(moduleId);
    if (markedQUnitModuleStructure == null) {
      throw new RuntimeException("'" + moduleEndMatcher.group() + "' references undefined module");
    }
    markedQUnitModuleStructure.endEncountered(TextRange.create(moduleEndMatcher.start(),moduleEndMatcher.end()),jsFile);
  }
}
