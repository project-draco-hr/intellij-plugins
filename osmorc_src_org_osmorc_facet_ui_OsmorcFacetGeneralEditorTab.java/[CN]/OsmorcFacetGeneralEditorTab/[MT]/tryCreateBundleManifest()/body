{
  final String manifestPath=getManifestLocation();
  if (StringUtil.isEmpty(manifestPath)) {
    return;
  }
  final VirtualFile[] contentRoots=getContentRoots(myModule);
  if (contentRoots.length > 0) {
    Application application=ApplicationManager.getApplication();
    application.runWriteAction(new Runnable(){
      public void run(){
        try {
          VirtualFile contentRoot=contentRoots[0];
          String completePath=contentRoot.getPath() + File.separator + manifestPath;
          completePath=completePath.replace('\\','/');
          int lastPathSep=completePath.lastIndexOf('/');
          String path=completePath.substring(0,lastPathSep);
          String filename=completePath.substring(lastPathSep + 1);
          VfsUtil.createDirectories(path);
          VirtualFile parentFolder=LocalFileSystem.getInstance().refreshAndFindFileByPath(path);
          String bundleName=myModule.getName();
          Version bundleVersion=null;
          int nextDotPos=bundleName.indexOf('.');
          while (bundleVersion == null && nextDotPos >= 0) {
            try {
              bundleVersion=new Version(bundleName.substring(nextDotPos + 1));
              bundleName=bundleName.substring(0,nextDotPos);
            }
 catch (            IllegalArgumentException e) {
            }
            nextDotPos=bundleName.indexOf('.',nextDotPos + 1);
          }
          VirtualFile manifest=parentFolder.createChildData(this,filename);
          String text=Attributes.Name.MANIFEST_VERSION + ": 1.0.0\n" + Constants.BUNDLE_MANIFESTVERSION+ ": 2\n"+ Constants.BUNDLE_NAME+ ": "+ bundleName+ "\n"+ Constants.BUNDLE_SYMBOLICNAME+ ": "+ bundleName+ "\n"+ Constants.BUNDLE_VERSION+ ": "+ (bundleVersion != null ? bundleVersion.toString() : "1.0.0")+ "\n";
          VfsUtil.saveText(manifest,text);
        }
 catch (        IOException e) {
          throw new RuntimeException(e);
        }
      }
    }
);
    VirtualFileManager.getInstance().refresh(false);
  }
}
