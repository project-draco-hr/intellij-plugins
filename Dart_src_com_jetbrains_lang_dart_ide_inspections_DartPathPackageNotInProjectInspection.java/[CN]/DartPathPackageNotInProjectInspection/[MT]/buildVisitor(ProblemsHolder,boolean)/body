{
  if (!PubspecYamlUtil.PUBSPEC_YAML.equals(holder.getFile().getName()))   return super.buildVisitor(holder,isOnTheFly);
  final Module module=ModuleUtilCore.findModuleForPsiElement(holder.getFile());
  final DartSdk sdk=DartSdk.getGlobalDartSdk();
  if (module == null || sdk == null || !DartSdkGlobalLibUtil.isDartSdkGlobalLibAttached(module,sdk.getGlobalLibName())) {
    return super.buildVisitor(holder,isOnTheFly);
  }
  return new PsiElementVisitor(){
    @Override public void visitElement(    final PsiElement element){
      ProgressIndicatorProvider.checkCanceled();
      if (!(element instanceof YAMLKeyValue) || !PubspecYamlUtil.PATH.equals(((YAMLKeyValue)element).getKeyText()))       return;
      final VirtualFile file=DartResolveUtil.getRealVirtualFile(element.getContainingFile());
      final String path=((YAMLKeyValue)element).getValueText() + "/" + PubspecYamlUtil.LIB_DIR_NAME;
      final VirtualFile packageDir=file == null ? null : VfsUtilCore.findRelativeFile(path,file.getParent());
      if (packageDir == null || !packageDir.isDirectory())       return;
      final PsiElement parent1=element.getParent();
      final PsiElement parent2=parent1 instanceof YAMLCompoundValue ? parent1.getParent() : null;
      final String packageName=parent2 instanceof YAMLKeyValue ? ((YAMLKeyValue)parent2).getKeyText() : null;
      if (packageName == null)       return;
      final PsiElement parent3=parent2.getParent();
      final PsiElement parent4=parent3 instanceof YAMLCompoundValue ? parent3.getParent() : null;
      if (!(parent4 instanceof YAMLKeyValue) || !(parent4.getParent() instanceof YAMLDocument) || (!PubspecYamlUtil.DEPENDENCIES.equals(((YAMLKeyValue)parent4).getKeyText()) && !PubspecYamlUtil.DEV_DEPENDENCIES.equals(((YAMLKeyValue)parent4).getKeyText()))) {
        return;
      }
      if (!ProjectRootManager.getInstance(element.getProject()).getFileIndex().isInContent(packageDir)) {
        final String message=DartBundle.message("folder.0.not.in.project.content",FileUtil.toSystemDependentName(packageDir.getPath()));
        holder.registerProblem(((YAMLKeyValue)element).getValue(),message,new AddContentRootFix(module,packageDir));
      }
    }
  }
;
}
