{
  myModuleOutputDir=JpsJavaExtensionService.getInstance().getOutputDirectory(myModule,false);
  if (myModuleOutputDir == null) {
    throw new OsgiBuildException("Unable to determine the compiler output path for the module.");
  }
  String jarFileLocation=myExtension.getJarFileLocation();
  if (jarFileLocation.isEmpty()) {
    throw new OsgiBuildException("Bundle path is empty - please check OSGi facet settings.");
  }
  myOutputJarFile=new File(jarFileLocation);
  if (!FileUtil.delete(myOutputJarFile)) {
    throw new OsgiBuildException("Can't delete bundle file '" + myOutputJarFile + "'.");
  }
  if (!FileUtil.createParentDirs(myOutputJarFile)) {
    throw new OsgiBuildException("Cannot create directory for bundle file '" + myOutputJarFile + "'.");
  }
  mySources=ContainerUtil.map2Array(myModule.getSourceRoots(),File.class,new Function<JpsModuleSourceRoot,File>(){
    @Override public File fun(    JpsModuleSourceRoot root){
      return root.getFile();
    }
  }
);
  myOutputDir=BndWrapper.getOutputDir(myModuleOutputDir);
  myBndWrapper=new BndWrapper(this);
}
