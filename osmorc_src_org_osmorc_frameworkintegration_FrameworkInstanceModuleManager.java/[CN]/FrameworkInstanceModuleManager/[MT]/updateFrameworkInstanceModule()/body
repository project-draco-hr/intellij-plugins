{
  if (projectSettings.isCreateFrameworkInstanceModule() && isExistsAtLeastOneOsmorcFacetInProject()) {
    ensureFrameworkInstanceModuleExists();
    updateModuleLibraries(projectSettings.getFrameworkInstanceName());
  }
 else {
    final Module module=getFrameworkInstanceModule();
    if (module != null) {
      application.runWriteAction(new Runnable(){
        public void run(){
          try {
            final VirtualFile file=module.getModuleFile();
            final ModifiableModuleModel moduleModel=moduleManager.getModifiableModel();
            moduleModel.disposeModule(module);
            moduleModel.commit();
            if (file != null && file.exists()) {
              file.delete(this);
            }
          }
 catch (          IOException e) {
            throw new RuntimeException(e);
          }
        }
      }
);
    }
  }
}
