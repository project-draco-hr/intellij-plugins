{
  PsiElement element=expression.resolve();
  if (element == null) {
    throw new InvalidPropertyException(expression,"unresolved.variable.or.type",expression.getReferencedName());
  }
  if (element instanceof JSClass) {
    writer.writeClass(((JSClass)element).getQualifiedName());
  }
 else   if (element instanceof JSVariable) {
    VariableReference valueReference=valueReferenceResolver.getNullableValueReference((JSVariable)element);
    if (valueReference != null) {
      valueReference.write(out,writer,valueReferenceResolver);
      return;
    }
    writeJSVariable(((JSVariable)element),out,writer,valueReferenceResolver);
  }
 else {
    out.write(ExpressionMessageTypes.MXML_OBJECT_REFERENCE);
    valueReferenceResolver.getValueReference(expression.getReferencedName()).write(out,writer,valueReferenceResolver);
  }
}
