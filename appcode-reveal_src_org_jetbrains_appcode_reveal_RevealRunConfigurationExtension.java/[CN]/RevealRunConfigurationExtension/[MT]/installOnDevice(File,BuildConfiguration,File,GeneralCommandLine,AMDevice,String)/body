{
  File tempDir;
  File libRevealInTempDir;
  try {
    tempDir=FileUtil.createTempDirectory("libReveal",null);
    libRevealInTempDir=new File(tempDir,libReveal.getName());
    FileUtil.copy(libReveal,libRevealInTempDir);
  }
 catch (  IOException e) {
    throw new ExecutionException("Cannot create a temporary copy of Reveal library",e);
  }
  try {
    AppCodeInstaller.codesignBinary(buildConfiguration,mainExecutable,tempDir.getAbsolutePath(),libRevealInTempDir.getName());
    AMDeviceUtil.transferPathToApplicationBundle(device,libRevealInTempDir.getParent(),"/tmp",bundleId);
  }
  finally {
    FileUtil.delete(tempDir);
  }
  String homeDir=AMDeviceUtil.getHomeDirFromAppEnvironment(commandLine);
  return new File(new File(homeDir),"tmp/" + libRevealInTempDir.getParentFile().getName() + "/"+ libRevealInTempDir.getName());
}
