{
  return ApplicationManager.getApplication().runReadAction(new Computable<ProcessingItem[]>(){
    public ProcessingItem[] compute(){
      try {
        final Collection<Pair<Module,FlexIdeBuildConfiguration>> modulesAndBCs=FlexCompiler.getModulesAndBCsToCompile(context.getCompileScope());
        final Collection<FlexResourceProcessingItem> result=new ArrayList<FlexResourceProcessingItem>();
        final Collection<Module> modules=new THashSet<Module>();
        for (        Pair<Module,FlexIdeBuildConfiguration> bc : modulesAndBCs) {
          final Module module=bc.first;
          if (modules.add(module)) {
            appendItemsForModule(result,module);
          }
        }
        return result.toArray(new ProcessingItem[result.size()]);
      }
 catch (      ConfigurationException e) {
        return ProcessingItem.EMPTY_ARRAY;
      }
    }
  }
);
}
