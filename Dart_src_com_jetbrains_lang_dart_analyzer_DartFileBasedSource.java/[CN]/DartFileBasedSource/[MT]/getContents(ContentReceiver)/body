{
  final Exception exception=ApplicationManager.getApplication().runReadAction(new NullableComputable<Exception>(){
    @Nullable public Exception compute(){
      final Document cachedDocument=FileDocumentManager.getInstance().getCachedDocument(myFile);
      if (cachedDocument != null) {
        myModificationStampWhenFileContentWasRead=cachedDocument.getModificationStamp();
        receiver.accept(cachedDocument.getText(),myModificationStampWhenFileContentWasRead);
      }
 else {
        myModificationStampWhenFileContentWasRead=myFile.getModificationStamp();
        try {
          receiver.accept(VfsUtilCore.loadText(myFile),myModificationStampWhenFileContentWasRead);
        }
 catch (        IOException e) {
          return e;
        }
      }
      return null;
    }
  }
);
  if (exception != null) {
    throw exception;
  }
}
