{
  final Project project=moduleInfo.getElement().getProject();
  for (  LibrarySet librarySet : moduleInfo.getLibrarySets()) {
    do {
      PropertiesFile propertiesFile;
      for (      Library library : librarySet.getLibraries()) {
        if (library.hasResourceBundles() && (propertiesFile=getResourceBundleFile(locale,bundleName,library,project)) != null) {
          return propertiesFile;
        }
      }
    }
 while ((librarySet=librarySet.getParent()) != null);
  }
  Sdk sdk=FlexUtils.getFlexSdkForFlexModuleOrItsFlexFacets(moduleInfo.getModule());
  VirtualFile dir=sdk == null ? null : sdk.getHomeDirectory();
  if (dir != null) {
    dir=dir.findFileByRelativePath("frameworks/projects");
  }
  if (dir != null) {
    for (    String libName : new String[]{"framework","spark","mx","airframework","rpc","advancedgrids","charts","textLayout"}) {
      VirtualFile file=dir.findFileByRelativePath(libName + "/bundles/" + locale+ "/"+ bundleName+ PROPERTIES_EXTENSION);
      if (file != null) {
        return virtualFileToProperties(project,file);
      }
    }
  }
  return null;
}
