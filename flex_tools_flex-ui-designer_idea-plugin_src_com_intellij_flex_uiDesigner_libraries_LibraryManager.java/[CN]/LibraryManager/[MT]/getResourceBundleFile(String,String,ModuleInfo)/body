{
  for (  LibrarySet librarySet : moduleInfo.getLibrarySets()) {
    do {
      PropertiesFile propertiesFile;
      final Project project=moduleInfo.getElement().getProject();
      for (      Library library : librarySet.getLibraries()) {
        if (library.hasResourceBundles() && (propertiesFile=getResourceBundleFile(locale,bundleName,library,project)) != null) {
          return propertiesFile;
        }
      }
      for (      Library library : librarySet.getResourceLibrariesOnly()) {
        if ((propertiesFile=getResourceBundleFile(locale,bundleName,library,project)) != null) {
          return propertiesFile;
        }
      }
    }
 while ((librarySet=librarySet.getParent()) != null);
  }
  return null;
}
