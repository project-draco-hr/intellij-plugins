{
  try {
    return new LibrarySorter().sort(libraries,isFromSdk,new File(appDir,librarySetId + SWF_EXTENSION),isExternal,definitionMapPostProcessor);
  }
 catch (  Throwable e) {
    String technicalMessage="Flex SDK " + flexSdkVersion;
    final Attachment[] attachments=new Attachment[libraries.size()];
    try {
      for (int i=0, librariesSize=libraries.size(); i < librariesSize; i++) {
        attachments[i]=new Attachment(libraries.get(i).getCatalogFile());
      }
    }
 catch (    Throwable innerE) {
      technicalMessage+=" Cannot collect library catalog files due to " + ExceptionUtil.getThrowableText(innerE);
    }
    throw new InitException(e,"error.sort.libraries",attachments,technicalMessage);
  }
}
