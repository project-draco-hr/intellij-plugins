{
  LibrarySet librarySet=projectInfo.getLibrarySet();
  do {
    for (    Library library : librarySet.getLibraries()) {
      if (library instanceof EmbedLibrary) {
        continue;
      }
      OriginalLibrary originalLibrary=library instanceof OriginalLibrary ? (OriginalLibrary)library : ((FilteredLibrary)library).originalLibrary;
      if (originalLibrary.hasResourceBundles()) {
        final THashSet<String> bundles=originalLibrary.resourceBundles.get(locale);
        if (bundles.contains(bundleName)) {
          VirtualFile virtualFile=originalLibrary.getFile().findChild("locale").findChild(locale).findChild(bundleName + CatalogXmlBuilder.PROPERTIES_EXTENSION);
          return (PropertiesFile)PsiDocumentManager.getInstance(projectInfo.getElement()).getPsiFile(FileDocumentManager.getInstance().getDocument(virtualFile));
        }
      }
    }
  }
 while ((librarySet=librarySet.getParent()) != null);
  return null;
}
