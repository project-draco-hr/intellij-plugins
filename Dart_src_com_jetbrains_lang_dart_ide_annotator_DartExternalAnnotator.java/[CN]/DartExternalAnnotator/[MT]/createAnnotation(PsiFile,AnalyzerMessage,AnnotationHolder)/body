{
  final Document document=file.getViewProvider().getDocument();
  if (document == null || message.getLine() < 0) {
    return;
  }
  final int startOffset=document.getLineStartOffset(message.getLine()) + message.getOffset();
  final TextRange textRange=new TextRange(startOffset,startOffset + message.getLength());
  PsiElement element=file.findElementAt(startOffset + message.getLength() / 2);
  while (element != null && textRange.getStartOffset() < element.getTextOffset()) {
    element=element.getParent();
  }
  boolean annotateByElement=element != null && textRange.equals(element.getTextRange());
  Annotation annotation=annotateByElement ? annotateElement(message,holder,element) : annotateTextRange(message,holder,textRange);
  if (annotation == null) {
    return;
  }
  List<? extends IntentionAction> fixes=null;
  if ("STATIC_WARNING".equals(message.getSubSystem())) {
    DartResolverErrorCode code=DartResolverErrorCode.findError(message.getErrorCode());
    fixes=code == null ? Collections.<IntentionAction>emptyList() : code.getFixes(file,startOffset,message.getMessage());
  }
 else   if ("STATIC_TYPE_WARNING".equals(message.getSubSystem())) {
    DartTypeErrorCode code=DartTypeErrorCode.findError(message.getErrorCode());
    fixes=code == null ? Collections.<IntentionAction>emptyList() : code.getFixes(file,startOffset,message.getMessage());
  }
 else {
    fixes=Collections.emptyList();
  }
  for (  IntentionAction intentionAction : fixes) {
    if (intentionAction instanceof FixAndIntentionAction) {
      ((FixAndIntentionAction)intentionAction).setElement(element);
    }
    annotation.registerFix(intentionAction);
  }
}
