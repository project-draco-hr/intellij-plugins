{
  Collection<File> dependencyFiles=JpsJavaExtensionService.getInstance().enumerateDependencies(Collections.singletonList(myModule)).withoutSdk().withoutModuleSourceEntries().withoutDepModules().productionOnly().runtimeOnly().recursively().exportedOnly().satisfying(NOT_FRAMEWORK_LIBRARY_CONDITION).classes().getRoots();
  List<File> result=new ArrayList<File>();
  for (  File dependencyFile : dependencyFiles) {
    if (JpsCachingBundleInfoProvider.canBeBundlified(dependencyFile)) {
      progressMessage("Bundling non-OSGi libraries for the module, dependency: " + dependencyFile.getAbsolutePath());
      File bundledDependencyFile=myBndWrapper.wrapLibrary(dependencyFile);
      if (bundledDependencyFile != null) {
        result.add(bundledDependencyFile);
      }
    }
 else     if (JpsCachingBundleInfoProvider.isBundle(dependencyFile)) {
      result.add(dependencyFile);
    }
  }
  return result;
}
