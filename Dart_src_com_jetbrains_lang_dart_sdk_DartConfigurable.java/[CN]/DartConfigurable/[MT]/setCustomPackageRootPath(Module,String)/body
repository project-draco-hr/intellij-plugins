{
  if (Comparing.equal(path,getCustomPackageRootPath(module)))   return;
  final ModifiableRootModel modifiableModel=ModuleRootManager.getInstance(module).getModifiableModel();
  try {
    for (    final OrderEntry entry : modifiableModel.getOrderEntries()) {
      if (isCustomPackageRootLibraryEntry(entry)) {
        modifiableModel.removeOrderEntry(entry);
      }
    }
    if (path != null) {
      final Library library=modifiableModel.getModuleLibraryTable().createLibrary(CUSTOM_PACKAGE_ROOT_LIB_NAME);
      final Library.ModifiableModel libModel=library.getModifiableModel();
      libModel.addRoot(VfsUtilCore.pathToUrl(path),OrderRootType.CLASSES);
      libModel.commit();
    }
    modifiableModel.commit();
  }
 catch (  Exception e) {
    if (!modifiableModel.isDisposed())     modifiableModel.dispose();
  }
}
