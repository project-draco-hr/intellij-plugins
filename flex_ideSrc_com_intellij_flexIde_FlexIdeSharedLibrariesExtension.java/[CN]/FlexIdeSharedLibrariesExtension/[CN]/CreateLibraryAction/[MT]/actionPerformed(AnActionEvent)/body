{
  final ModuleStructureConfigurable modulesConfig=ProjectStructureConfigurable.getInstance(myProject).getModulesConfig();
  final Tree tree=modulesConfig.getTree();
  StructureConfigurableContext context=ProjectStructureConfigurable.getInstance(myProject).getContext();
  LibrariesModifiableModel modifiableModel=context.createModifiableModelProvider(myLevel).getModifiableModel();
  Library library=CreateNewLibraryAction.createLibrary(FlexLibraryType.getInstance(),tree,myProject,modifiableModel);
  TreeNode root=(TreeNode)tree.getModel().getRoot();
  MasterDetailsComponent.MyNode globalLibrariesNode=MasterDetailsComponent.findNodeByObject(root,myParentNodeValue);
  LibraryNode libraryNode=new LibraryNode(library,context,myTreeUpdater);
  modulesConfig.addNode(libraryNode,globalLibrariesNode);
  modulesConfig.selectNodeInTree(libraryNode);
}
