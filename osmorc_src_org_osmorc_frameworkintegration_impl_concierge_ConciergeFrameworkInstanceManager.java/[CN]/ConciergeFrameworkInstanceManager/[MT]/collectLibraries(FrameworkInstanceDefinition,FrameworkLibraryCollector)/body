{
  final VirtualFile installFolder=getLocalFileSystem().findFileByPath(frameworkInstanceDefinition.getBaseFolder());
  final ArrayList<VirtualFile> directoriesToAdd=new ArrayList<VirtualFile>();
  if (installFolder == null) {
    LOG.warn("The folder " + frameworkInstanceDefinition.getBaseFolder() + " does not exist.");
    return;
  }
  if (!installFolder.isDirectory()) {
    LOG.warn(frameworkInstanceDefinition.getBaseFolder() + " is not a folder");
    return;
  }
  directoriesToAdd.add(installFolder);
  VirtualFile bundlesFolder=installFolder.findChild("bundles");
  if (bundlesFolder != null) {
    if (!bundlesFolder.isDirectory()) {
      LOG.warn(bundlesFolder.getPath() + " is not a folder");
    }
 else {
      directoriesToAdd.add(bundlesFolder);
    }
  }
  myApplication.runWriteAction(new Runnable(){
    public void run(){
      installFolder.refresh(false,true);
      ConciergeSourceFinder sourceFinder=new ConciergeSourceFinder(installFolder);
      collector.collectFrameworkLibraries(sourceFinder,directoriesToAdd);
    }
  }
);
}
