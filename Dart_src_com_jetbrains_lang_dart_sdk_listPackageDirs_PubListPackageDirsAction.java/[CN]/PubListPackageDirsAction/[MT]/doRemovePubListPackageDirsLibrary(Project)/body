{
  for (  final Module module : ModuleManager.getInstance(project).getModules()) {
    final ModifiableRootModel modifiableModel=ModuleRootManager.getInstance(module).getModifiableModel();
    try {
      for (      final OrderEntry entry : modifiableModel.getOrderEntries()) {
        if (entry instanceof LibraryOrderEntry && LibraryTablesRegistrar.PROJECT_LEVEL.equals(((LibraryOrderEntry)entry).getLibraryLevel()) && DartPackagesLibraryType.DART_PACKAGES_LIBRARY_NAME.equals(((LibraryOrderEntry)entry).getLibraryName())) {
          modifiableModel.removeOrderEntry(entry);
        }
      }
      if (modifiableModel.isChanged()) {
        modifiableModel.commit();
      }
    }
  finally {
      if (!modifiableModel.isDisposed()) {
        modifiableModel.dispose();
      }
    }
  }
  final Library library=ProjectLibraryTable.getInstance(project).getLibraryByName(DartPackagesLibraryType.DART_PACKAGES_LIBRARY_NAME);
  if (library != null) {
    ProjectLibraryTable.getInstance(project).removeLibrary(library);
  }
}
