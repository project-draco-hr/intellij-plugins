{
  if (ideaSdkName == null) {
    buildConfiguration.setTargetPlatform(TargetPlatform.Web);
    return null;
  }
  Pair<String,IFlexSdkType.Subtype> homePathAndSubtype=ConversionParams.getIdeaSdkHomePathAndSubtype(ideaSdkName,ideaSdkType);
  if (homePathAndSubtype == null) {
    buildConfiguration.setTargetPlatform(TargetPlatform.Web);
    return null;
  }
  if (IFlexSdkType.Subtype.AIRMobile == homePathAndSubtype.second) {
    buildConfiguration.setTargetPlatform(TargetPlatform.Mobile);
    buildConfiguration.getAndroidPackagingOptions().setEnabled(true);
  }
 else   if (IFlexSdkType.Subtype.AIR == homePathAndSubtype.second) {
    buildConfiguration.setTargetPlatform(TargetPlatform.Desktop);
  }
 else {
    buildConfiguration.setTargetPlatform(TargetPlatform.Web);
  }
  FlexSdk sdk=myParams.getOrCreateFlexIdeSdk(homePathAndSubtype.first);
  SdkEntry sdkEntry=Factory.createSdkEntry(sdk.getLibraryId(),sdk.getHomePath());
  buildConfiguration.getDependencies().setSdkEntry(sdkEntry);
  if (existingSdkLibrariesIds == null || existingSdkLibrariesIds.add(sdk.getLibraryId())) {
    Element orderEntryElement=new Element(OrderEntryFactory.ORDER_ENTRY_ELEMENT_NAME);
    orderEntryElement.setAttribute(OrderEntryFactory.ORDER_ENTRY_TYPE_ATTR,"library");
    orderEntryElement.setAttribute("name",sdk.getLibrary().getName());
    orderEntryElement.setAttribute("level",LibraryTablesRegistrar.APPLICATION_LEVEL);
    return orderEntryElement;
  }
 else {
    return null;
  }
}
