{
  final Project project=e.getData(PlatformDataKeys.PROJECT);
  final CreateHtmlWrapperDialog dialog=new CreateHtmlWrapperDialog(project);
  dialog.show();
  if (dialog.isOK()) {
    try {
      final HTMLWrapperParameters htmlWrapperParameters=dialog.getHTMLWrapperParameters();
      final VirtualFile htmlFile=createHtmlWrapper(htmlWrapperParameters);
      if (htmlFile != null) {
        if (dialog.isCreateRunConfigurationSelected() && project != null) {
          FlexModuleBuilder.createFlexRunConfiguration(project,htmlFile);
        }
        CreateAirDescriptorAction.NOTIFICATION_GROUP.createNotification("",FlexBundle.message("file.created",htmlFile.getName()),NotificationType.INFORMATION,new NotificationListener(){
          @Override public void hyperlinkUpdate(          @NotNull Notification notification,          @NotNull HyperlinkEvent e){
            if (e.getEventType() == HyperlinkEvent.EventType.ACTIVATED && htmlFile.isValid()) {
              FileEditorManager.getInstance(project).openTextEditor(new OpenFileDescriptor(project,htmlFile),true);
            }
          }
        }
).notify(project);
      }
 else {
        Messages.showErrorDialog(project,FlexBundle.message("html.wrapper.creation.failed",""),FlexBundle.message("error.title"));
      }
    }
 catch (    IOException ex) {
      Messages.showErrorDialog(project,FlexBundle.message("html.wrapper.creation.failed",ex.getMessage()),"Error");
    }
  }
}
