{
  Map<Module,List<FlexIdeBCConfigurable>> treeItems=new HashMap<Module,List<FlexIdeBCConfigurable>>();
  FlexIdeBCConfigurator configurator=FlexBuildConfigurationsExtension.getInstance().getConfigurator();
  for (  Module module : ModuleStructureConfigurable.getInstance(project).getModules()) {
    if (ModuleType.get(module) != FlexModuleType.getInstance()) {
      continue;
    }
    for (    CompositeConfigurable configurable : configurator.getBCConfigurables(module)) {
      FlexIdeBCConfigurable flexIdeBCConfigurable=FlexIdeBCConfigurable.unwrap(configurable);
      if (!filter.value(flexIdeBCConfigurable)) {
        continue;
      }
      List<FlexIdeBCConfigurable> list=treeItems.get(module);
      if (list == null) {
        list=new ArrayList<FlexIdeBCConfigurable>();
        treeItems.put(module,list);
      }
      list.add(flexIdeBCConfigurable);
    }
  }
  if (treeItems.isEmpty()) {
    return null;
  }
  return new ChooseBuildConfigurationDialog(title,labelText,project,allowEmptySelection,treeItems);
}
