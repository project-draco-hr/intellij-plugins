{
  Set<String> allKeys=new THashSet<String>();
  final GlobalSearchScope scope=GlobalSearchScope.allScope(projectAndIndex.first);
  final CommonProcessors.CollectProcessor<String> processor=new CommonProcessors.CollectProcessor<String>(allKeys){
    @Override protected boolean accept(    String key){
      return true;
    }
  }
;
  FileBasedIndex.getInstance().processAllKeys(projectAndIndex.second,processor,scope,null);
  return CachedValueProvider.Result.create(ContainerUtil.filter(allKeys,new Condition<String>(){
    @Override public boolean value(    String key){
      return !FileBasedIndex.getInstance().processValues(projectAndIndex.second,key,null,new FileBasedIndex.ValueProcessor<Void>(){
        @Override public boolean process(        VirtualFile file,        Void value){
          return false;
        }
      }
,scope);
    }
  }
),PsiManager.getInstance(projectAndIndex.first).getModificationTracker());
}
