{
  List<String> fileNames=Lists.newArrayList();
  File file=descendant;
  boolean ancestorMet=false;
  boolean add=myIncludeDescendant;
  while (file != null) {
    if (add) {
      String name=file.getName();
      if (name.isEmpty() && OUR_FILE_SYSTEM_ROOTS.contains(file)) {
        name=file.getAbsolutePath();
      }
      fileNames.add(name);
    }
    if (ancestorMet) {
      break;
    }
    file=file.getParentFile();
    ancestorMet=ancestor.equals(file);
    add=!ancestorMet || myIncludeAncestor;
  }
  if (!ancestorMet) {
    throw new RuntimeException("Ancestor is not visited! (ancestor:'" + ancestor + "', descendant:'"+ descendant+ "')");
  }
  if (myFromAncestorToDescendant) {
    Collections.reverse(fileNames);
  }
  return fileNames;
}
