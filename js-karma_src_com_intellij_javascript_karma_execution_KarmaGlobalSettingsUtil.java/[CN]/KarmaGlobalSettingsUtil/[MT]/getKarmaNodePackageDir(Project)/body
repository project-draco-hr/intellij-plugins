{
  PropertiesComponent propertiesComponent=PropertiesComponent.getInstance();
  String karmaNodePackageDir=propertiesComponent.getValue(KARMA_NODE_PACKAGE_DIR);
  if (StringUtil.isEmpty(karmaNodePackageDir)) {
    ResolvedModuleInfo moduleInfo=NodeModuleSearchUtil.resolveModule(NODE_NODE_PACKAGE_NAME,project.getBaseDir(),getNodeSettings());
    if (moduleInfo != null) {
      VirtualFile dir=moduleInfo.getModuleSourceRoot();
      if (dir.isDirectory()) {
        karmaNodePackageDir=FileUtil.toSystemDependentName(dir.getPath());
      }
    }
  }
  return karmaNodePackageDir;
}
