{
  myConfigurationFile=configurationFile;
  myKarmaIntellijPackageDir=findKarmaIntellijPackageDir(karmaPackageDir);
  try {
    myProcessHandler=startServer(nodeInterpreter,configurationFile);
  }
 catch (  ExecutionException e) {
    throw new IOException("Can not create karma server process",e);
  }
  myProcessEventStore=new ProcessEventStore(myProcessHandler);
  myProcessEventStore.addStreamEventListener(new StreamEventListener(){
    @Override public void on(    @NotNull String eventText){
      System.out.println("Got " + eventText);
    }
  }
);
  myProcessEventStore.startNotify();
  Disposer.register(ApplicationManager.getApplication(),new Disposable(){
    @Override public void dispose(){
      if (!myProcessHandler.isProcessTerminated()) {
        ScriptRunnerUtil.terminateProcessHandler(myProcessHandler,500,null);
      }
    }
  }
);
}
