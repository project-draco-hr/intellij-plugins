{
  myKarmaPackageDir=karmaPackageDir;
  myKarmaJsSourcesLocator=new KarmaJsSourcesLocator(karmaPackageDir);
  final ProcessHandler processHandler=startServer(nodeInterpreter,configurationFile);
  myState=new KarmaServerState(this,processHandler,configurationFile);
  myProcessOutputArchive=new ProcessOutputArchive(processHandler);
  myWatcher=new KarmaWatcher(this);
  registerStreamEventHandlers();
  myProcessOutputArchive.startNotify();
  myDisposable=new MyDisposable();
  Disposer.register(ApplicationManager.getApplication(),myDisposable);
  myRestarter=new KarmaServerRestarter(configurationFile,myDisposable);
}
