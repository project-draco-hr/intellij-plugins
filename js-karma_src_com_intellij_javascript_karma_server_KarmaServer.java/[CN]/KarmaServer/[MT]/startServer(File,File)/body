{
  GeneralCommandLine commandLine=new GeneralCommandLine();
  commandLine.setPassParentEnvironment(true);
  commandLine.setWorkDirectory(configurationFile.getParentFile());
  commandLine.setExePath(nodeInterpreter.getAbsolutePath());
  File serverFile=getServerAppFile();
  commandLine.addParameter(serverFile.getAbsolutePath());
  commandLine.addParameter("--karmaPackageDir=" + myKarmaPackageDir.getAbsolutePath());
  commandLine.addParameter("--configFile=" + configurationFile.getAbsolutePath());
  LOG.info("Starting karma server: " + commandLine.getCommandLineString());
  final Process process=commandLine.createProcess();
  KillableColoredProcessHandler processHandler=new KillableColoredProcessHandler(process,commandLine.getCommandLineString(),CharsetToolkit.UTF8_CHARSET);
  processHandler.addProcessListener(new ProcessAdapter(){
    @Override public void onTextAvailable(    ProcessEvent event,    Key outputType){
      String text=event.getText().trim();
      if (text != null && outputType == ProcessOutputTypes.STDOUT) {
        handleStdout(text);
      }
    }
    @Override public void processTerminated(    ProcessEvent event){
      KarmaServerRegistry.serverTerminated(KarmaServer.this);
      fireOnTerminated(event.getExitCode());
    }
  }
);
  ProcessTerminatedListener.attach(processHandler);
  processHandler.setShouldDestroyProcessRecursively(true);
  return processHandler;
}
