{
  DartSettings settings=null;
  if (module == null || ModuleType.get(module) instanceof WebModuleTypeBase || ApplicationManager.getApplication().isUnitTestMode()) {
    settings=DartSettingsUtil.getSettings();
  }
 else   if (ModuleType.get(module) instanceof DartModuleType) {
    final ModuleRootManager moduleRootManager=ModuleRootManager.getInstance(module);
    final Sdk sdk=moduleRootManager.getSdk();
    settings=new DartSettings(StringUtil.notNullize(sdk == null ? null : sdk.getHomePath()));
  }
  return settings;
}
