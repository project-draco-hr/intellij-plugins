{
  ApplicationManager.getApplication().getMessageBus().connect().subscribe(AppTopics.FILE_DOCUMENT_SYNC,new FileDocumentManagerAdapter(){
    @Override public void beforeDocumentSaving(    Document document){
      final VirtualFile file=FileDocumentManager.getInstance().getFile(document);
      if (file == null) {
        return;
      }
      DocumentInfo info=file.getUserData(INFO);
      if (!isRegistered(info) || FlexUIDesignerApplicationManager.getInstance().isDocumentOpening()) {
        return;
      }
      Project project=ProjectLocator.getInstance().guessProjectForFile(file);
      if (project == null) {
        return;
      }
      final Module moduleForFile=ModuleUtil.findModuleForFile(file,project);
      if (moduleForFile == null) {
        return;
      }
      XmlFile psiFile=(XmlFile)PsiDocumentManager.getInstance(project).getPsiFile(document);
      if (psiFile == null) {
        return;
      }
      FlexUIDesignerApplicationManager.getInstance().openDocument(project,moduleForFile,psiFile,false);
    }
  }
);
}
