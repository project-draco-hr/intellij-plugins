{
  for (  Element element : runManagerSettings.getRunConfigurations()) {
    final String confType=element.getAttributeValue("type");
    if (EQUINOX_RUN_CONFIGURATION_TYPE.equals(confType)) {
      String application=element.getAttributeValue(APPLICATION_ATTRIBUTE);
      String product=element.getAttributeValue(PRODUCT_ATTRIBUTE);
      String workingDir=element.getAttributeValue(WORKING_DIR_ATTRIBUTE);
      String configDir=element.getAttributeValue(CONFIG_DIR_ATTRIBUTE);
      String jvmArgs=element.getAttributeValue(JVM_ARGS_ATTRIBUTE);
      String additionalEquinoxArgs=element.getAttributeValue(ADDITIONAL_ARGS_ATTRIBUTE);
      boolean equinoxConsole=Boolean.valueOf(element.getAttributeValue(EQUINOX_CONSOLE,"false"));
      boolean equinoxDebug=Boolean.valueOf(element.getAttributeValue(EQUINOX_DEBUG,"false"));
      boolean clean=Boolean.valueOf(element.getAttributeValue(CLEAN,"true"));
      element.removeAttribute(APPLICATION_ATTRIBUTE);
      element.removeAttribute(PRODUCT_ATTRIBUTE);
      element.removeAttribute(WORKING_DIR_ATTRIBUTE);
      element.removeAttribute(CONFIG_DIR_ATTRIBUTE);
      element.removeAttribute(JVM_ARGS_ATTRIBUTE);
      element.removeAttribute(ADDITIONAL_ARGS_ATTRIBUTE);
      element.removeAttribute(EQUINOX_CONSOLE);
      element.removeAttribute(EQUINOX_DEBUG);
      element.removeAttribute(USE_UPDATE_CONFIGURATOR);
      element.removeAttribute(CLEAN);
      OsgiRunConfiguration osgiRunConfiguration=new OsgiRunConfiguration(null,null,null);
      osgiRunConfiguration.setWorkingDir(workingDir);
      osgiRunConfiguration.setVmParameters(jvmArgs);
      osgiRunConfiguration.setProgramParameters(additionalEquinoxArgs);
      Map<String,String> properties=osgiRunConfiguration.getAdditionalProperties();
      GenericRunProperties.setDebugMode(properties,equinoxDebug);
      GenericRunProperties.setStartConsole(properties,equinoxConsole);
      EquinoxRunProperties.setEquinoxProduct(properties,product);
      EquinoxRunProperties.setEquinoxApplication(properties,application);
      osgiRunConfiguration.putAdditionalProperties(properties);
      SelectedBundle legacyLoader=new SelectedBundle(SelectedBundle.BundleType.FrameworkBundle,"legacyLoader","org.osmorc.frameworkintegration.impl.equinox.LegacyEquinoxOsgiRunConfigurationLoader");
      osgiRunConfiguration.setBundlesToDeploy(Collections.singletonList(legacyLoader));
      element.setAttribute("type","#org.osmorc.OsgiConfigurationType");
      element.setAttribute("factoryName","OSGi Bundles");
      try {
        osgiRunConfiguration.writeExternal(element);
      }
 catch (      WriteExternalException e) {
        throw new CannotConvertException("Error while converting legacy Eclipse Equinox run configuration",e);
      }
    }
  }
}
