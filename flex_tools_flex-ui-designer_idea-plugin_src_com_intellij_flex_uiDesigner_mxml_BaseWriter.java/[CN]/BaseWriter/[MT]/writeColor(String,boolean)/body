{
  out.write(AmfExtendedTypes.COLOR_STYLE_MARKER);
  if (value.charAt(0) == '#') {
    if (isPrimitiveStyle) {
      out.write(CssPropertyType.COLOR_INT);
    }
    value=value.substring(1);
  }
 else   if (value.charAt(0) == '0') {
    if (isPrimitiveStyle) {
      out.write(CssPropertyType.COLOR_INT);
    }
    value=value.substring(2);
  }
 else {
    final String colorName=value.toLowerCase();
    if (isPrimitiveStyle) {
      out.write(CssPropertyType.COLOR_STRING);
      stringWriter.writeNullable(colorName,out);
    }
    final String hexCodeForColorName=ColorSampleLookupValue.getHexCodeForColorName(colorName);
    if (hexCodeForColorName == null) {
      throw new InvalidProperty("error.invalid.color.name",colorName);
    }
 else {
      value=hexCodeForColorName.substring(1);
    }
  }
  out.writeAmfUInt(Integer.parseInt(value,16));
}
