{
  if (referenceTarget instanceof PyTargetExpression) {
    PyTargetExpression target=(PyTargetExpression)referenceTarget;
    final PsiFile containingFile=target.getContainingFile();
    if (containingFile != null && containingFile.getName().equals(FlaskNames.GLOBALS_PY)) {
      if (FlaskNames.REQUEST.equals(target.getName())) {
        return getClassType(referenceTarget,FlaskNames.REQUEST_CLASS);
      }
      if (FlaskNames.SESSION.equals(target.getName())) {
        return getClassType(referenceTarget,FlaskNames.SESSION_CLASS);
      }
    }
  }
  if (referenceTarget instanceof PyFunction) {
    PyFunction function=(PyFunction)referenceTarget;
    if (FlaskNames.JINJA_ENV.equals(function.getQualifiedName())) {
      return getClassType(function,FlaskNames.ENVIRONMENT_CLASS);
    }
  }
  return super.getReferenceType(referenceTarget,context,anchor);
}
