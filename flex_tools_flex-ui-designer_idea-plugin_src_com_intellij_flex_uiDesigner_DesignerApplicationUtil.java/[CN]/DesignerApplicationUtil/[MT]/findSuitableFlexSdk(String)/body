{
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    return createTestAdlRunConfiguration();
  }
  final List<Sdk> sdks=new ArrayList<Sdk>();
  for (  Sdk sdk : ProjectJdkTable.getInstance().getAllJdks()) {
    if (sdk.getSdkType() instanceof IFlexSdkType && StringUtil.compareVersionNumbers(sdk.getVersionString(),"4.5") >= 0) {
      sdks.add(sdk);
    }
  }
  Collections.sort(sdks,new Comparator<Sdk>(){
    @Override public int compare(    Sdk o1,    Sdk o2){
      return StringUtil.compareVersionNumbers(o2.getVersionString(),o1.getVersionString());
    }
  }
);
  String adlPath;
  String runtime=findInstalledRuntime();
  for (  Sdk sdk : sdks) {
    adlPath=FlexSdkUtils.getAdlPath(sdk);
    if (StringUtil.isEmpty(adlPath) || !new File(adlPath).exists()) {
      continue;
    }
    if (runtime == null) {
      runtime=FlexSdkUtils.getAirRuntimePath(sdk);
    }
    if (!checkRuntime(adlPath,runtime,checkDescriptorPath)) {
      runtime=null;
      continue;
    }
    return new AdlRunConfiguration(adlPath,runtime);
  }
  return null;
}
