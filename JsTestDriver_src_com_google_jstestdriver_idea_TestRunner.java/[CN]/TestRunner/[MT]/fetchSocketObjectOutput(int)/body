{
  try {
    SocketAddress endpoint=new InetSocketAddress(InetAddress.getByName(null),port);
    final Socket socket=connectToServer(endpoint,2 * 1000,5);
    try {
      return new ObjectOutputStream(socket.getOutputStream()){
        @Override public void close() throws IOException {
          socket.close();
        }
      }
;
    }
 catch (    IOException inner) {
      closeSocketSilently(socket);
      throw inner;
    }
  }
 catch (  IOException e) {
    throw new RuntimeException("Could not connect to IDE, address: " + "'localhost:" + port + "'",e);
  }
}
