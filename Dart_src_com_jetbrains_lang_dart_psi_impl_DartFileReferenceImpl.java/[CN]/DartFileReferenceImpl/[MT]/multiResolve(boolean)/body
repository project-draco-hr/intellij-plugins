{
  final PsiFile psiFile=getContainingFile();
  final VirtualFile virtualFile=DartResolveUtil.getRealVirtualFile(psiFile);
  final String text=StringUtil.unquoteString(getText());
  if (text.startsWith(DartResolveUtil.PACKAGE_PREFIX)) {
    final VirtualFile packagesFolder=DartResolveUtil.getDartPackagesFolder(getProject(),virtualFile);
    String relativePath=FileUtil.toSystemIndependentName(text.substring(DartResolveUtil.PACKAGE_PREFIX.length()));
    final VirtualFile sourceFile=packagesFolder == null ? null : VfsUtilCore.findRelativeFile(relativePath,packagesFolder);
    final PsiFile sourcePsiFile=sourceFile == null ? null : psiFile.getManager().findFile(sourceFile);
    return sourcePsiFile == null ? ResolveResult.EMPTY_ARRAY : new ResolveResult[]{new PsiElementResolveResult(sourcePsiFile)};
  }
  VirtualFile sourceFile=virtualFile == null ? null : DartResolveUtil.findRelativeFile(virtualFile,text);
  sourceFile=sourceFile != null ? sourceFile : VirtualFileManager.getInstance().findFileByUrl(text);
  if (sourceFile != null) {
    final PsiFile sourcePsiFile=psiFile.getManager().findFile(sourceFile);
    return sourcePsiFile == null ? ResolveResult.EMPTY_ARRAY : new ResolveResult[]{new PsiElementResolveResult(sourcePsiFile)};
  }
  return tryResolveLibraries();
}
