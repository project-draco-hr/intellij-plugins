{
  String annotationPackage=CUCUMBER_1_1_ANNOTATION_PACKAGE;
  final String version=CucumberConfigUtil.getCucumberCoreVersion(step);
  if (version != null && version.compareTo(CucumberConfigUtil.CUCUMBER_VERSION_1_1) < 0) {
    annotationPackage=CUCUMBER_1_0_ANNOTATION_PACKAGE;
  }
  final PsiElementFactory factory=JavaPsiFacade.getInstance(step.getProject()).getElementFactory();
  final Step cucumberStep=new Step(new ArrayList<Comment>(),step.getKeyword().getText(),step.getStepName(),0,null,null);
  final String snippet=new SnippetGenerator(new JavaSnippet()).getSnippet(cucumberStep).replace("PendingException","cucumber.runtime.PendingException").replaceFirst("@",annotationPackage).replaceAll("\\\\\\\\","\\\\").replaceAll("\\\\d","\\\\\\\\d");
  return factory.createMethodFromText(snippet,step);
}
