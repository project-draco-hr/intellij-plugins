{
  final VirtualFile vFile=DartResolveUtil.getRealVirtualFile(psiFile);
  if (vFile == null)   return null;
  final Ref<List<AnalysisErrorFixes>> resultFixes=new Ref<List<AnalysisErrorFixes>>();
  final Semaphore semaphore=new Semaphore();
  semaphore.down();
  final String path=FileUtil.toSystemDependentName(vFile.getPath());
  myServer.edit_getFixes(path,offset,new GetFixesConsumer(){
    @Override public void computedFixes(    final List<AnalysisErrorFixes> fixes){
      semaphore.up();
      resultFixes.set(fixes);
    }
    @Override public void onError(    final RequestError error){
      semaphore.up();
      LOG.warn("Error from edit_getFixes() for file " + path + ", code="+ error.getCode()+ ": "+ error.getMessage());
    }
  }
);
  final long t0=System.currentTimeMillis();
  semaphore.waitFor(GET_FIXES_TIMEOUT);
  if (semaphore.tryUp()) {
    LOG.info("edit_getFixes() took too long for file " + path + ": "+ (System.currentTimeMillis() - t0)+ "ms");
    return null;
  }
  return resultFixes.get();
}
