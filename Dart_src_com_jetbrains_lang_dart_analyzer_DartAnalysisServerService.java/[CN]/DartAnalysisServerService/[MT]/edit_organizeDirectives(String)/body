{
  final String filePath=FileUtil.toSystemDependentName(_filePath);
  final Ref<SourceFileEdit> resultRef=new Ref<SourceFileEdit>();
  final Semaphore semaphore=new Semaphore();
synchronized (myLock) {
    if (myServer == null)     return null;
    semaphore.down();
    final OrganizeDirectivesConsumer consumer=new OrganizeDirectivesConsumer(){
      @Override public void computedEdit(      final SourceFileEdit edit){
        resultRef.set(edit);
        semaphore.up();
      }
      @Override public void onError(      final RequestError error){
        if (RequestErrorCode.FILE_NOT_ANALYZED.equals(error.getCode()) || RequestErrorCode.ORGANIZE_DIRECTIVES_ERROR.equals(error.getCode())) {
          LOG.info(getShortErrorMessage("edit_organizeDirectives()",filePath,error));
        }
 else {
          logError("edit_organizeDirectives()",filePath,error);
        }
        semaphore.up();
      }
    }
;
    myServer.edit_organizeDirectives(filePath,consumer);
  }
  final long t0=System.currentTimeMillis();
  semaphore.waitFor(EDIT_ORGANIZE_DIRECTIVES_TIMEOUT);
  if (semaphore.tryUp()) {
    LOG.info("edit_organizeDirectives() took too long for file " + filePath + ": "+ (System.currentTimeMillis() - t0)+ "ms");
    return null;
  }
  return resultRef.get();
}
