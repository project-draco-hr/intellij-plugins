{
  final DartSdk sdk=DartSdk.getGlobalDartSdk();
  if (sdk == null) {
    LOG.error("No SDK");
    return;
  }
  final String sdkPath=sdk.getHomePath();
  final String runtimePath=sdkPath + "/bin/dart";
  final String analysisServerPath=sdkPath + "/bin/snapshots/analysis_server.dart.snapshot";
  final DebugPrintStream debugStream=new DebugPrintStream(){
    @Override public void println(    String str){
    }
  }
;
  final StdioServerSocket serverSocket=new StdioServerSocket(runtimePath,analysisServerPath,null,debugStream,new String[]{"--port=10000"},false,false,0,false);
  myServer=new RemoteAnalysisServerImpl(serverSocket);
  try {
    myServer.start();
  }
 catch (  Exception e) {
    LOG.debug(e.getMessage(),e);
  }
  ArrayList<String> included=new ArrayList<String>();
  for (  final Module module : ModuleManager.getInstance(project).getModules()) {
    for (    VirtualFile contentRoot : ModuleRootManager.getInstance(module).getContentRoots()) {
      included.add(contentRoot.getPath());
    }
  }
  myServer.analysis_setAnalysisRoots(included,null,null);
  myServer.addAnalysisServerListener(myListener);
}
