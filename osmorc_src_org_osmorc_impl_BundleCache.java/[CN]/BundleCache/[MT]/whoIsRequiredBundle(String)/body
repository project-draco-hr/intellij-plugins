{
  List<ManifestHolder> candidates=new ArrayList<ManifestHolder>();
  for (  ManifestHolder manifestHolder : myManifestHolders) {
    BundleManifest bundleManifest;
    try {
      bundleManifest=manifestHolder.getBundleManifest();
    }
 catch (    ManifestHolderDisposedException ignore) {
      continue;
    }
    if (bundleManifest != null) {
      if (bundleManifest.isRequiredBundle(requiredBundleSpec)) {
        candidates.add(manifestHolder);
      }
    }
  }
  if (candidates.isEmpty()) {
    return null;
  }
  if (candidates.size() == 1) {
    return candidates.iterator().next();
  }
  ManifestHolder result=null;
  for (  ManifestHolder candidate : candidates) {
    if (result == null) {
      result=candidate;
      continue;
    }
    BundleManifest resultManifest;
    try {
      resultManifest=result.getBundleManifest();
      if (resultManifest == null) {
        result=candidate;
        continue;
      }
    }
 catch (    ManifestHolderDisposedException e) {
      result=candidate;
      continue;
    }
    try {
      BundleManifest bundleManifest=candidate.getBundleManifest();
      if (bundleManifest == null) {
        continue;
      }
      Version candidateVersion=bundleManifest.getBundleVersion();
      Version resultVersion=resultManifest.getBundleVersion();
      if (resultVersion.compareTo(candidateVersion) < 0) {
        result=candidate;
      }
    }
 catch (    ManifestHolderDisposedException e) {
    }
  }
  return result;
}
