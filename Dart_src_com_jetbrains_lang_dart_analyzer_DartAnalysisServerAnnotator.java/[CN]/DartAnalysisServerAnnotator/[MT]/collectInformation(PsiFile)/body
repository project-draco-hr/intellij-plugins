{
  if (psiFile instanceof DartExpressionCodeFragment)   return null;
  final VirtualFile annotatedFile=DartResolveUtil.getRealVirtualFile(psiFile);
  if (annotatedFile == null)   return null;
  final Module module=ModuleUtilCore.findModuleForPsiElement(psiFile);
  if (module == null)   return null;
  final DartSdk sdk=DartSdk.getDartSdk(module.getProject());
  if (sdk == null || StringUtil.compareVersionNumbers(sdk.getVersion(),DartAnalysisServerService.MIN_SDK_VERSION) < 0)   return null;
  if (!DartSdkGlobalLibUtil.isDartSdkGlobalLibAttached(module,sdk.getGlobalLibName()))   return null;
  if (psiFile instanceof XmlFile && !DartInProcessAnnotator.containsDartEmbeddedContent((XmlFile)psiFile))   return null;
  if (DartWritingAccessProvider.isInDartSdkOrDartPackagesFolder(psiFile))   return null;
  if (!DartAnalysisServerService.getInstance().serverReadyForRequest(module.getProject(),sdk))   return null;
  DartAnalysisServerService.getInstance().updateFilesContent();
  return new AnnotatorInfo(psiFile.getProject(),annotatedFile.getPath());
}
