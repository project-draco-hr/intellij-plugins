{
  result=result.withPrefixMatcher(new PlainPrefixMatcher(result.getPrefixMatcher().getPrefix()));
  final List<AbstractStepDefinition> definitions=CucumberStepsIndex.getInstance(file.getProject()).getAllStepDefinitions(file);
  for (  AbstractStepDefinition definition : definitions) {
    String text=definition.getElementText();
    if (text != null) {
      if (text.startsWith("^")) {
        text=text.substring(1);
      }
      if (text.endsWith("$")) {
        text=text.substring(0,text.length() - 1);
      }
      text=StringUtil.replace(text,"\\\"","\"");
      for (      Map.Entry<String,String> group : GROUP_TYPE_MAP.entrySet()) {
        text=StringUtil.replace(text,group.getKey(),group.getValue());
      }
      final List<TextRange> ranges=new ArrayList<TextRange>();
      Pattern p=Pattern.compile(POSSIBLE_GROUP_REGEX);
      Matcher m=p.matcher(text);
      while (m.find()) {
        ranges.add(new TextRange(m.start(),m.end() - 3));
        text=m.replaceAll("$1");
        m=p.matcher(text);
      }
      final Pattern pattern=Pattern.compile(PARAMETERS_REGEX);
      m=pattern.matcher(text);
      while (m.find()) {
        ranges.add(new TextRange(m.start(),m.end()));
      }
      result.addElement(LookupElementBuilder.create(text).withInsertHandler(new StepInsertHandler(ranges)));
    }
  }
}
