{
  final XmlFile file=(XmlFile)InjectedLanguageUtil.getTopLevelFile(element);
  final JSResolveUtil.JSInjectedFilesVisitor visitor=new JSResolveUtil.JSInjectedFilesVisitor(){
    @Override protected void process(    JSFile file){
      file.accept(new JSRecursiveElementVisitor(){
        @Override public void visitJSVariable(        JSVariable node){
          if (scopeMatches(element,node)) {
            consumer.consume(node);
          }
          super.visitJSVariable(node);
        }
      }
);
    }
  }
;
  final XmlDocument document=file.getDocument();
  if (document == null)   return;
  for (  XmlTag tag : PsiTreeUtil.getChildrenOfTypeAsList(document,XmlTag.class)) {
    new XmlBackedJSClassImpl.InjectedScriptsVisitor(tag,null,true,true,visitor,true).go();
  }
}
