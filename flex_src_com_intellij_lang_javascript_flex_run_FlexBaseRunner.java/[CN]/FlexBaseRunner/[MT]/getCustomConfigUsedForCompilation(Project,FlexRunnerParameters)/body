{
  String[] swfFileNames=null;
  if (!(params instanceof AirRunnerParameters) && params.getRunMode() == FlexRunnerParameters.RunMode.HtmlOrSwfFile) {
    final String[] swfFilePaths=FlashPlayerTrustUtil.getSwfFilesCanonicalPaths(project,params);
    swfFileNames=new String[swfFilePaths.length];
    for (int i=0; i < swfFilePaths.length; i++) {
      swfFileNames[i]=swfFilePaths[i].substring(FileUtil.toSystemIndependentName(swfFilePaths[i]).lastIndexOf("/") + 1);
    }
  }
 else   if (params instanceof AirRunnerParameters && !(params instanceof FlexUnitRunnerParameters) && ((AirRunnerParameters)params).getAirRunMode() == AirRunnerParameters.AirRunMode.AppDescriptor) {
    final VirtualFile descriptorFile=LocalFileSystem.getInstance().findFileByPath(((AirRunnerParameters)params).getAirDescriptorPath());
    if (descriptorFile != null) {
      try {
        final String swfFilePath=FlexUtils.findXMLElement(descriptorFile.getInputStream(),"<application><initialWindow><content>");
        if (swfFilePath != null) {
          swfFileNames=new String[]{swfFilePath.substring(FileUtil.toSystemIndependentName(swfFilePath).lastIndexOf("/") + 1)};
        }
      }
 catch (      IOException e) {
      }
    }
  }
  if (swfFileNames != null && swfFileNames.length > 0) {
    final Module module=ModuleManager.getInstance(project).findModuleByName(params.getModuleName());
    for (    final FlexBuildConfiguration config : FlexBuildConfiguration.getConfigForFlexModuleOrItsFlexFacets(module)) {
      if (config.DO_BUILD && config.OUTPUT_TYPE.equals(FlexBuildConfiguration.APPLICATION) && config.USE_CUSTOM_CONFIG_FILE) {
        final VirtualFile configFile=LocalFileSystem.getInstance().findFileByPath(config.CUSTOM_CONFIG_FILE);
        if (configFile != null) {
          try {
            final String outputFilePath=FlexUtils.findXMLElement(configFile.getInputStream(),"<flex-config><output>");
            if (outputFilePath != null) {
              for (              final String swfFileName : swfFileNames) {
                if (outputFilePath.endsWith(swfFileName)) {
                  return configFile;
                }
              }
            }
          }
 catch (          IOException e) {
          }
        }
      }
    }
    return null;
  }
  return null;
}
