{
  myGlobalSettingsRef.remove();
  String nodeInterpreterPath=KarmaGlobalSettingsUtil.getNodeInterpreterPath();
  String karmaPackagePath=KarmaGlobalSettingsUtil.getKarmaNodePackageDir(getProject(),myRunSettings.getConfigPath());
  boolean ok=true;
  try {
    check(nodeInterpreterPath,karmaPackagePath);
  }
 catch (  RuntimeConfigurationError e) {
    ok=false;
    throw e;
  }
 finally {
    if (ok && nodeInterpreterPath != null && karmaPackagePath != null) {
      myGlobalSettingsRef.set(new GlobalSettings(nodeInterpreterPath,karmaPackagePath));
    }
  }
}
