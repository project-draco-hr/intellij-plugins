{
  FileDocumentManager.getInstance().saveAllDocuments();
  ExecutionResult executionResult=state.execute(env.getExecutor(),this);
  if (executionResult == null) {
    return null;
  }
  KarmaConsoleView consoleView=KarmaConsoleView.get(executionResult);
  if (consoleView == null) {
    LOG.error("Can't get KarmaConsoleView from executionResult!");
    return null;
  }
  RunContentBuilder contentBuilder=new RunContentBuilder(project,this,env.getExecutor(),executionResult,env);
  final RunContentDescriptor descriptor=contentBuilder.showRunContent(contentToReuse);
  final KarmaServer karmaServer=consoleView.getKarmaExecutionSession().getKarmaServer();
  if (!karmaServer.isReady() || !karmaServer.hasCapturedBrowsers()) {
    karmaServer.doWhenReadyWithCapturedBrowser(new Runnable(){
      @Override public void run(){
        KarmaUtil.restart(descriptor);
      }
    }
);
  }
  return descriptor;
}
