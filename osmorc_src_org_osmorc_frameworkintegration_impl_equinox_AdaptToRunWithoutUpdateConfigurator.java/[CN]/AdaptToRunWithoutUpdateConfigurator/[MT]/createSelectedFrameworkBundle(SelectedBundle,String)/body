{
  url=BundleCompiler.convertJarUrlToFileUrl(url);
  url=BundleCompiler.fixFileURL(url);
  String bundleName=CachingBundleInfoProvider.getBundleSymbolicName(url);
  SelectedBundle bundle=null;
  if (bundleName != null) {
    bundle=prototypeBundle;
    String bundleVersion=CachingBundleInfoProvider.getBundleVersions(url);
    String displayName=bundleName + " - " + bundleVersion;
    if (prototypeBundle != null) {
      bundle.setName(displayName);
      bundle.setBundleUrl(url);
    }
 else {
      bundle=new SelectedBundle(displayName,url,SelectedBundle.BundleType.FrameworkBundle);
    }
  }
  return bundle;
}
