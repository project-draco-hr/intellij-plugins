{
  final VirtualFile sdkHome=LocalFileSystem.getInstance().findFileByPath(homePath);
  LibraryEx library=(LibraryEx)myProvider.getGlobalLibrariesModifiableModel().createLibrary("Flex SDK",FlexSdkLibraryType.getInstance());
  LibraryEx.ModifiableModelEx libraryModifiableModel=(LibraryEx.ModifiableModelEx)library.getModifiableModel();
  ((FlexSdkProperties)libraryModifiableModel.getProperties()).setId(UUID.randomUUID().toString());
  ((FlexSdkProperties)libraryModifiableModel.getProperties()).setHomePath(homePath);
  final FlexSdkModificator sdkModificator=new FlexSdkModificator(libraryModifiableModel);
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      FlexSdkUtils.setupSdkPaths(sdkHome,null,sdkModificator);
    }
  }
);
  return library;
}
