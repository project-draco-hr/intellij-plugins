{
  LOG.assertTrue(FlexBuildConfigurationsExtension.getInstance().getConfigurator().getConfigEditor() == null,"Don't create FlexProjectConfigurationEditor when Project Structure dialog is open. Use FlexIdeBCConfigurator.getConfigEditor()");
  final ProjectModifiableModelProvider provider=new ProjectModifiableModelProvider(){
    public Module[] getModules(){
      final Set<Module> modules=moduleToModifiableModel.keySet();
      return modules.toArray(new Module[modules.size()]);
    }
    public ModifiableRootModel getModuleModifiableModel(    final Module module){
      final ModifiableRootModel model=moduleToModifiableModel.get(module);
      LOG.assertTrue(model != null,"No model for module " + module.getName());
      return model;
    }
    public void addListener(    final FlexIdeBCConfigurator.Listener listener,    final Disposable parentDisposable){
    }
    public void commitModifiableModels() throws ConfigurationException {
    }
    public LibraryTableBase.ModifiableModelEx getLibrariesModifiableModel(    final String level){
      if (LibraryTablesRegistrar.APPLICATION_LEVEL.equals(level)) {
        LOG.assertTrue(globalLibrariesModel != null);
        return globalLibrariesModel;
      }
 else       if (LibraryTablesRegistrar.PROJECT_LEVEL.equals(level)) {
        LOG.assertTrue(projectLibrariesModel != null);
        return projectLibrariesModel;
      }
      LOG.error("Unexpected argument: " + level);
      return null;
    }
    public Sdk[] getAllSdks(){
      return FlexProjectConfigurationEditor.getPersistedFlexSdks();
    }
  }
;
  return new FlexProjectConfigurationEditor(project,provider);
}
