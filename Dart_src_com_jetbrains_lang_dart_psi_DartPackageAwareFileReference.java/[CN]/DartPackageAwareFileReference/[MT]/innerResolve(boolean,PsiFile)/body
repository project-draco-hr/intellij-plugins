{
  if (PACKAGES_FOLDER_NAME.equals(getText())) {
    final VirtualFile pubspecYamlFile=myDartResolver.getPubspecYamlFile();
    final VirtualFile packagesDir=pubspecYamlFile == null ? null : pubspecYamlFile.getParent().findChild(PACKAGES_FOLDER_NAME);
    final PsiDirectory psiDirectory=packagesDir == null ? null : containingFile.getManager().findDirectory(packagesDir);
    if (psiDirectory != null) {
      return new ResolveResult[]{new PsiElementResolveResult(psiDirectory)};
    }
  }
  final int index=getIndex();
  if (index > 0 && PACKAGES_FOLDER_NAME.equals(getFileReferenceSet().getReference(index - 1).getText())) {
    final VirtualFile packageDir=myDartResolver.getPackageDirIfLivePackageOrFromPubListPackageDirs(getText());
    final PsiDirectory psiDirectory=packageDir == null ? null : containingFile.getManager().findDirectory(packageDir);
    if (psiDirectory != null) {
      return new ResolveResult[]{new PsiElementResolveResult(psiDirectory)};
    }
  }
  return super.innerResolve(caseSensitive,containingFile);
}
