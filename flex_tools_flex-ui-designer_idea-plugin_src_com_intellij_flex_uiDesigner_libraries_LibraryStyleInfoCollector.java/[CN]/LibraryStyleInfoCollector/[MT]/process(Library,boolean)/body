{
  if (!isNew) {
    assetCounter.append(library.assetCounter);
    return;
  }
  try {
    library.inheritingStyles=collectInherited(library.getFile());
  }
  finally {
    bytes.reset();
  }
  final VirtualFile defaultsCssVirtualFile=library.getDefaultsCssFile();
  if (defaultsCssVirtualFile != null) {
    final AssetCounter libAssetCounter=new AssetCounter();
    library.defaultsStyle=new CssWriter(stringWriter,problemsHolder,libAssetCounter).write(defaultsCssVirtualFile,module);
    library.assetCounter=libAssetCounter;
    assetCounter.append(libAssetCounter);
  }
}
