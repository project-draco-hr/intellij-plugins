{
  final Pair<Module,FlexIdeBuildConfiguration> moduleAndBC=super.checkAndGetModuleAndBC(project);
  doCheck(moduleAndBC);
  if (myOverrideMainClass) {
    final ModifiableFlexIdeBuildConfiguration overriddenBC=Factory.getTemporaryCopyForCompilation(moduleAndBC.second);
    overriddenBC.setMainClass(myOverriddenMainClass);
    overriddenBC.setOutputFileName(myOverriddenOutputFileName);
    overriddenBC.getAndroidPackagingOptions().setPackageFileName(FileUtil.getNameWithoutExtension(myOverriddenOutputFileName));
    overriddenBC.getIosPackagingOptions().setPackageFileName(FileUtil.getNameWithoutExtension(myOverriddenOutputFileName));
    if (overriddenBC.getOutputType() != OutputType.Application) {
      overriddenBC.setOutputType(OutputType.Application);
      overriddenBC.setUseHtmlWrapper(false);
      overriddenBC.setRLMs(Collections.<FlexIdeBuildConfiguration.RLMInfo>emptyList());
      overriddenBC.setCssFilesToCompile(Collections.<String>emptyList());
      overriddenBC.getDependencies().setFrameworkLinkage(LinkageType.Merged);
      for (      ModifiableDependencyEntry entry : overriddenBC.getDependencies().getModifiableEntries()) {
        if (entry.getDependencyType().getLinkageType() == LinkageType.External) {
          entry.getDependencyType().setLinkageType(LinkageType.Merged);
        }
      }
      overriddenBC.getAirDesktopPackagingOptions().setUseGeneratedDescriptor(true);
      final ModifiableAndroidPackagingOptions androidOptions=overriddenBC.getAndroidPackagingOptions();
      androidOptions.setEnabled(true);
      androidOptions.setUseGeneratedDescriptor(true);
      androidOptions.getSigningOptions().setUseTempCertificate(true);
      overriddenBC.getIosPackagingOptions().setEnabled(false);
    }
    if (BCUtils.canHaveResourceFiles(overriddenBC.getNature()) && !BCUtils.canHaveResourceFiles(moduleAndBC.second.getNature())) {
      overriddenBC.getCompilerOptions().setResourceFilesMode(CompilerOptions.ResourceFilesMode.None);
    }
    return Pair.create(moduleAndBC.first,((FlexIdeBuildConfiguration)overriddenBC));
  }
  return moduleAndBC;
}
