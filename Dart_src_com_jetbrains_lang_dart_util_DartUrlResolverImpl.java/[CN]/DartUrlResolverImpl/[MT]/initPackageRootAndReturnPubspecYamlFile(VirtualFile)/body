{
  final Module module=ModuleUtilCore.findModuleForFile(contextFile,myProject);
  if (module == null)   return null;
  final VirtualFile customPackageRoot=DartConfigurable.getCustomPackageRoot(module);
  if (customPackageRoot != null) {
    myPackageRoot=customPackageRoot;
    return null;
  }
  final VirtualFile pubspecYamlFile=PubspecYamlUtil.findPubspecYamlFile(myProject,contextFile);
  if (myDartSdk == null || StringUtil.compareVersionNumbers(myDartSdk.getVersion(),"1.12") < 0) {
    final VirtualFile parentFolder=pubspecYamlFile == null ? null : pubspecYamlFile.getParent();
    final VirtualFile packagesFolder=parentFolder == null ? null : parentFolder.findChild(PACKAGES_FOLDER_NAME);
    if (packagesFolder != null && packagesFolder.isDirectory()) {
      myPackageRoot=packagesFolder;
    }
  }
  return pubspecYamlFile;
}
