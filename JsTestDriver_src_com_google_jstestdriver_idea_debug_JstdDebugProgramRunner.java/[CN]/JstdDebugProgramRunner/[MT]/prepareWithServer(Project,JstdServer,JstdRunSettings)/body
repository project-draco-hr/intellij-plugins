{
  if (server.isReadyForRunningTests()) {
    final JstdDebugBrowserInfo debugBrowserInfo=JstdDebugBrowserInfo.build(server,runSettings);
    if (debugBrowserInfo != null) {
      return debugBrowserInfo.getDebugEngine().prepareDebugger(project,debugBrowserInfo.getBrowser()).then(new Function<Void,RunProfileStarter>(){
        @Override public RunProfileStarter fun(        Void aVoid){
          return new MyDebugStarter(server,debugBrowserInfo);
        }
      }
);
    }
 else {
      return Promise.<RunProfileStarter>resolve(new RunProfileStarter(){
        @Nullable @Override public RunContentDescriptor execute(        @NotNull RunProfileState state,        @NotNull ExecutionEnvironment environment) throws ExecutionException {
          throw new ExecutionException("Please capture Chrome or Firefox and try again");
        }
      }
);
    }
  }
 else {
    return Promise.<RunProfileStarter>resolve(new JstdRunProgramRunner.JstdRunStarter(server,true));
  }
}
