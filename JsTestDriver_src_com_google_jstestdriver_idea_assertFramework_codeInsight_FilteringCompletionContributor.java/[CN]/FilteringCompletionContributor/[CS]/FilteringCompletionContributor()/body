{
  extend(CompletionType.BASIC,PlatformPatterns.psiElement(),new CompletionProvider<CompletionParameters>(){
    @Override protected void addCompletions(    @NotNull CompletionParameters parameters,    ProcessingContext context,    @NotNull final CompletionResultSet result){
      final List<JsCallTemplateContextProvider> providers=filterContextProviders(result.getPrefixMatcher().getPrefix(),parameters);
      final Ref<CompletionSorter> firstSorterRef=Ref.create(null);
      result.runRemainingContributors(parameters,new Consumer<CompletionResult>(){
        @Override public void consume(        CompletionResult completionResult){
          LookupElement element=completionResult.getLookupElement();
          if (!canWeDoBetter(element,providers)) {
            result.passResult(completionResult);
            if (firstSorterRef.isNull()) {
              firstSorterRef.set(completionResult.getSorter());
            }
          }
        }
      }
,true);
      CompletionSorter firstSorter=firstSorterRef.get();
      CompletionResultSet newResult=firstSorter != null ? result.withRelevanceSorter(firstSorter) : result;
      fillCallTemplateVariants(newResult,providers);
    }
  }
);
}
