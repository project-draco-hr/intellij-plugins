{
  final Document document=editor.getDocument();
  for (  SourceFileEdit fileEdit : myChange.getEdits()) {
    for (    SourceEdit edit : fileEdit.getEdits()) {
      if (edit.getLength() > 0) {
        document.deleteString(edit.getOffset(),edit.getOffset() + edit.getLength());
      }
      final TemplateManager templateManager=TemplateManager.getInstance(project);
      Template template=templateManager.createTemplate("","");
      template.setToReformat(true);
      addContents(template,edit);
      final VirtualFile virtualFile=LocalFileSystem.getInstance().findFileByPath(FileUtil.toSystemIndependentName(fileEdit.getFile()));
      if (virtualFile != null) {
        final Editor targetEditor=BaseCreateFix.navigate(project,edit.getOffset(),virtualFile);
        if (targetEditor != null) {
          templateManager.startTemplate(targetEditor,template);
        }
      }
    }
  }
}
