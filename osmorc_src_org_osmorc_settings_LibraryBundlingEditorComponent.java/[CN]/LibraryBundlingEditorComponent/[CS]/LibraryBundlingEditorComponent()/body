{
  addRuleButton.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent event){
      LibraryBundlificationRule newRule=new LibraryBundlificationRule();
      rules.add(newRule);
      selectedRule.fireIntervalAdded(rules.size() - 1,rules.size() - 1);
      selectedRule.setSelection(newRule);
      notifyChanged();
    }
  }
);
  removeRuleButton.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent event){
      if (rules.size() == 1) {
        LibraryBundlificationRule newRule=new LibraryBundlificationRule();
        rules.set(0,newRule);
        selectedRule.fireContentsChanged(0,1);
        selectedRule.setSelection(newRule);
      }
 else {
        int oldSelectionIndex=selectedRule.getSelectionIndex();
        rules.remove(selectedRule.getValue());
        selectedRule.fireIntervalRemoved(rules.size(),rules.size());
        final int newSelectionIndex=oldSelectionIndex > 0 ? oldSelectionIndex - 1 : oldSelectionIndex;
        if (newSelectionIndex == oldSelectionIndex) {
          selectedRule.clearSelection();
        }
        selectedRule.setSelectionIndex(newSelectionIndex);
      }
      notifyChanged();
    }
  }
);
  duplicateButton.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent event){
      LibraryBundlificationRule rule=selectedRule.getSelection();
      if (rule != null) {
        LibraryBundlificationRule newRule=rule.copy();
        int selectedIndex=selectedRule.getSelectionIndex();
        rules.add(selectedIndex,newRule);
        selectedRule.fireIntervalAdded(selectedIndex,selectedIndex);
        notifyChanged();
      }
    }
  }
);
  upButton.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent event){
      int selectionIndex=selectedRule.getSelectionIndex();
      if (selectionIndex > 0) {
        LibraryBundlificationRule ruleToMove=rules.get(selectionIndex);
        rules.set(selectionIndex,rules.get(selectionIndex - 1));
        rules.set(selectionIndex - 1,ruleToMove);
        selectedRule.fireContentsChanged(selectionIndex - 1,selectionIndex);
        selectedRule.setSelectionIndex(selectionIndex - 1);
        notifyChanged();
      }
    }
  }
);
  downButton.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent event){
      int selectionIndex=selectedRule.getSelectionIndex();
      if (selectionIndex < rules.size() - 1) {
        LibraryBundlificationRule ruleToMove=rules.get(selectionIndex);
        rules.set(selectionIndex,rules.get(selectionIndex + 1));
        rules.set(selectionIndex + 1,ruleToMove);
        selectedRule.fireContentsChanged(selectionIndex,selectionIndex + 1);
        selectedRule.setSelectionIndex(selectionIndex + 1);
        notifyChanged();
      }
    }
  }
);
  final DataContext dataContext=DataManager.getInstance().getDataContext();
  Project project=PlatformDataKeys.PROJECT.getData(dataContext);
  if (project == null) {
    project=ProjectManager.getInstance().getDefaultProject();
  }
  manifestEntries=new ManifestEditor(project,"");
  Bindings.bind(manifestEntries,"text",beanAdapter.getValueModel("additionalProperties"));
  _manifestEntriesHolder.add(manifestEntries,BorderLayout.CENTER);
  beanAdapter.addBeanPropertyChangeListener(beanPropertyChangeListener);
}
