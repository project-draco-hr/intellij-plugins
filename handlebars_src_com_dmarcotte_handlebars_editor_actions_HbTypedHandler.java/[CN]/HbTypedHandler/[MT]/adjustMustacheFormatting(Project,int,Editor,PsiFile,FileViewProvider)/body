{
  if (!HbConfig.isFormattingEnabled()) {
    return;
  }
  PsiElement elementAtCaret=provider.findElementAt(offset - 1,HbLanguage.class);
  PsiElement closeOrSimpleInverseParent=PsiTreeUtil.findFirstParent(elementAtCaret,true,new Condition<PsiElement>(){
    @Override public boolean value(    PsiElement element){
      return element != null && (element instanceof HbSimpleInverse || element instanceof HbCloseBlockMustache);
    }
  }
);
  if (closeOrSimpleInverseParent != null) {
    PsiDocumentManager.getInstance(project).commitDocument(editor.getDocument());
    CaretModel caretModel=editor.getCaretModel();
    CodeStyleManager codeStyleManager=CodeStyleManager.getInstance(project);
    codeStyleManager.adjustLineIndent(file,editor.getDocument().getLineStartOffset(caretModel.getLogicalPosition().line));
  }
}
