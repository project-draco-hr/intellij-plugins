{
  if (!(((LibraryEx)library).getType() instanceof FlexLibraryType)) {
    return false;
  }
  ChooseBuildConfigurationDialog d=ChooseBuildConfigurationDialog.createForApplicableBCs(FlexBundle.message("choose.bc.dialog.title"),FlexBundle.message("choose.bc.dialog.label",library.getName()),project,true,new Condition<FlexIdeBCConfigurable>(){
    @Override public boolean value(    final FlexIdeBCConfigurable configurable){
      for (      DependencyEntry entry : configurable.getEditableObject().getDependencies().getEntries()) {
        if (entry instanceof SharedLibraryEntry) {
          if (((SharedLibraryEntry)entry).getLibraryName().equals(library.getName()) && ((SharedLibraryEntry)entry).getLibraryLevel().equals(library.getTable().getTableLevel())) {
            return false;
          }
        }
      }
      return true;
    }
  }
);
  if (d == null) {
    return true;
  }
  d.show();
  if (!d.isOK()) {
    return true;
  }
  for (  FlexIdeBCConfigurable c : d.getSelectedConfigurables()) {
    c.addSharedLibrary(library);
  }
  return true;
}
