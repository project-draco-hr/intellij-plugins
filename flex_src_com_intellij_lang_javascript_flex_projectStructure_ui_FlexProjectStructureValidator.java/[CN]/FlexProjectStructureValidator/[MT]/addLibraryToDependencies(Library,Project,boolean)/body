{
  if (!(((LibraryEx)library).getKind() == FlexLibraryType.FLEX_LIBRARY)) {
    return false;
  }
  ChooseBuildConfigurationDialog d=ChooseBuildConfigurationDialog.createForApplicableBCs(FlexBundle.message("choose.bc.dialog.title"),FlexBundle.message("choose.bc.dialog.label",library.getName()),project,allowEmptySelection,new Condition<FlexBCConfigurable>(){
    @Override public boolean value(    final FlexBCConfigurable configurable){
      for (      DependencyEntry entry : configurable.getEditableObject().getDependencies().getEntries()) {
        if (entry instanceof SharedLibraryEntry) {
          if (((SharedLibraryEntry)entry).getLibraryName().equals(library.getName()) && ((SharedLibraryEntry)entry).getLibraryLevel().equals(library.getTable().getTableLevel())) {
            return false;
          }
        }
      }
      return true;
    }
  }
);
  if (d == null) {
    return true;
  }
  if (!d.showAndGet()) {
    return true;
  }
  for (  FlexBCConfigurable c : d.getSelectedConfigurables()) {
    c.addSharedLibrary(library);
  }
  return true;
}
