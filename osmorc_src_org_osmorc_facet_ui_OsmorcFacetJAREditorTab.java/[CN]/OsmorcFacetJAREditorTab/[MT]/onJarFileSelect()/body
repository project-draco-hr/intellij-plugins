{
  String currentFile=_jarFileChooser.getText();
  VirtualFile moduleCompilerOutputPath=CompilerModuleExtension.getInstance(_editorContext.getModule()).getCompilerOutputPath();
  if (moduleCompilerOutputPath == null) {
    String outputPathUrl=CompilerModuleExtension.getInstance(_editorContext.getModule()).getCompilerOutputUrl();
    try {
      VfsUtil.createDirectories(VfsUtil.urlToPath(outputPathUrl));
    }
 catch (    IOException e) {
      Messages.showErrorDialog(_root,OsmorcBundle.getTranslation("error"),OsmorcBundle.getTranslation("faceteditor.cannot.create.outputpath"));
      return;
    }
    moduleCompilerOutputPath=CompilerModuleExtension.getInstance(_editorContext.getModule()).getCompilerOutputPath();
    if (moduleCompilerOutputPath == null) {
      throw new IllegalStateException("Cannot access compiler output path.");
    }
  }
  String preselectedFileName=StringUtil.isNotEmpty(currentFile) ? currentFile : moduleCompilerOutputPath.getParent().getPath();
  File file=new File(preselectedFileName);
  if (!file.exists()) {
    preselectedFileName=file.getParent();
  }
  JFileChooser jfilechooser=new JFileChooser(preselectedFileName);
  FileView fileview=new FileView(){
    public Icon getIcon(    File aFile){
      if (aFile.isDirectory()) {
        return super.getIcon(aFile);
      }
 else {
        FileType filetype=FileTypeManager.getInstance().getFileTypeByFileName(aFile.getName());
        return filetype.getIcon();
      }
    }
  }
;
  jfilechooser.setFileView(fileview);
  jfilechooser.setMultiSelectionEnabled(false);
  jfilechooser.setAcceptAllFileFilterUsed(false);
  jfilechooser.setDialogTitle(OsmorcBundle.getTranslation("faceteditor.selectjar.title"));
  jfilechooser.addChoosableFileFilter(new FileTypeFilter(StdFileTypes.ARCHIVE));
  if (jfilechooser.showSaveDialog(WindowManager.getInstance().suggestParentWindow(_editorContext.getProject())) != 0) {
    return;
  }
  file=jfilechooser.getSelectedFile();
  if (file != null && VfsUtil.isAncestor(new File(moduleCompilerOutputPath.getPath()),file,false)) {
    _jarFileChooser.setText("");
    Messages.showErrorDialog(_editorContext.getProject(),OsmorcBundle.getTranslation("error"),OsmorcBundle.getTranslation("faceteditor.jar.cannot.be.in.output.path"));
    return;
  }
  _jarFileChooser.setText(file.getPath());
}
