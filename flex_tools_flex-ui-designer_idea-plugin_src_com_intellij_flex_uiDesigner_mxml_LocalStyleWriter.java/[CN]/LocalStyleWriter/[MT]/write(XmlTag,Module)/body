{
  data=null;
  CssFile cssFile=null;
  XmlAttribute source=tag.getAttribute("source");
  if (source != null) {
    XmlAttributeValue valueElement=source.getValueElement();
    if (valueElement != null) {
      PsiReference reference=valueElement.getReference();
      if (reference != null) {
        PsiElement element=reference.resolve();
        if (element != null && element instanceof CssFile) {
          cssFile=(CssFile)element;
        }
      }
    }
  }
 else {
    PsiElement host=XmlTagValueProvider.getInjectedHost(tag);
    if (host != null) {
      InjectedPsiVisitor visitor=new InjectedPsiVisitor(host);
      InjectedLanguageUtil.enumerate(host,visitor);
      cssFile=visitor.getCssFile();
    }
  }
  if (cssFile == null) {
    return false;
  }
  data=cssWriter.write(cssFile,module,problemsHolder);
  return true;
}
