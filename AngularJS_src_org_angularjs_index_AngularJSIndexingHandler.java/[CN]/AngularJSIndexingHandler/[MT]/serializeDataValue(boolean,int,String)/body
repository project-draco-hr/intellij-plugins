{
  final byte[] valueBytes=value != null ? value.getBytes(Charset.forName("UTF-8")) : new byte[0];
  final byte[] result=new byte[5 + valueBytes.length];
  result[0]=(byte)(isComment ? 1 : 0);
  for (int i=4; i >= 1; i--) {
    result[i]=(byte)(offset & 0xFF);
    offset>>=8;
  }
  System.arraycopy(valueBytes,0,result,5,result.length - 5);
  return result;
}
