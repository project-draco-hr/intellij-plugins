{
  final DataContext dataContext=e.getDataContext();
  final Context context=Context.build(dataContext,this);
  if (context == null) {
    throw new RuntimeException("Can't fetch " + JstdQUnitCreateTestAction.class.getSimpleName() + " from ActionEvent "+ e);
  }
  TemplateManager templateManager=TemplateManager.getInstance(context.getProject());
  Template template=new TemplateImpl("","");
  template.setToIndent(true);
  template.setToReformat(true);
  template.setToShortenLongNames(false);
  PsiElement precedingPsiElement=context.getPrecedingPsiElement();
  JSExpression[] argExpressions=context.getArgExpressions();
  if (argExpressions.length == 1) {
    template.addTextSegment(", {\n");
    addMethodInsideObjectLiteral(template,false,false);
    template.addTextSegment("}\n");
  }
 else   if (argExpressions.length == 2) {
    boolean leadingComma=precedingPsiElement instanceof JSProperty;
    addMethodInsideObjectLiteral(template,leadingComma,!leadingComma);
  }
  int insertOffset=precedingPsiElement.getTextOffset() + precedingPsiElement.getTextLength();
  context.getEditor().getCaretModel().moveToOffset(insertOffset);
  templateManager.startTemplate(context.getEditor(),"",template);
}
