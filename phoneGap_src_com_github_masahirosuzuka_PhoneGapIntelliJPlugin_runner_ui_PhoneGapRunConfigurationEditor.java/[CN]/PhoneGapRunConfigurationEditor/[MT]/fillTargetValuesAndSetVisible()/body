{
  setTargetFieldsEnable();
  if (myTarget.isEnabled()) {
    final String platform=getPlatformAsCodeFromField();
    final String command=(String)myCommand.getSelectedItem();
    ApplicationManager.getApplication().executeOnPooledThread(new Runnable(){
      @Override public void run(){
        final String currentText=myTarget.getText();
        PhoneGapTargets targetsProvider=myTargetsProvider;
        if (targetsProvider == null || !targetsProvider.platform().equals(platform)) {
          targetsProvider=PhoneGapTargets.createTargetsList(myProject,platform);
          myTargetsProvider=targetsProvider;
        }
        final List<String> targets=ContainerUtil.newArrayList(PhoneGapTargets.listTargets(targetsProvider,command));
        if (!StringUtil.isEmpty(currentText) && !targets.contains(currentText)) {
          targets.add(currentText);
        }
        UIUtil.invokeLaterIfNeeded(new Runnable(){
          @Override public void run(){
            if (platform == getPlatformAsCodeFromField()) {
              myTarget.setHistory(targets);
              PhoneGapUtil.setTextFieldWithHistory(myTarget,currentText);
            }
          }
        }
);
      }
    }
);
  }
}
