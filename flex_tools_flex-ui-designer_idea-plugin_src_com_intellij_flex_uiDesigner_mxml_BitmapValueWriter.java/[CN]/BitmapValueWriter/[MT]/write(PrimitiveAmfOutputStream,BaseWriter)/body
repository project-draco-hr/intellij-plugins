{
  out.write(AmfExtendedTypes.BITMAP);
  int id;
  if ((id=checkRegistered(out)) == -1) {
    return;
  }
  final BufferedImage image;
  try {
    image=getImage();
  }
 catch (  IOException e) {
    LOG.error(e);
    return;
  }
  writer.addDirectWriter(2 + 2 + 1+ (image.getWidth() * image.getHeight() * 4),new MyDirectWriter(id,image,mimeType == null ? virtualFile.getName().endsWith(".png") : mimeType.equals("image/png")));
}
