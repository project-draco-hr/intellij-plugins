{
  out.write(AmfExtendedTypes.BITMAP);
  if (checkRegistered(out)) {
    return;
  }
  final BufferedImage image;
  try {
    image=getImage();
  }
 catch (  IOException e) {
    LOG.error(e);
    return;
  }
  out.getBlockOut().addDirectMarker(2 + 2 + 1+ (image.getWidth() * image.getHeight() * 4),new MyDirectWriter(out.size(),image,mimeType == null ? virtualFile.getName().endsWith(".png") : mimeType.equals("image/png")));
}
