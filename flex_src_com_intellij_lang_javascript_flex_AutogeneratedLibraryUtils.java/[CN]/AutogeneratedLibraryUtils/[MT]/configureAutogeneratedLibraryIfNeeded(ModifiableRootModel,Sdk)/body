{
  Library autogeneratedLibraryEqualToFlexSdk=null;
  final LibraryTable libraryTable=modifiableRootModel.getModuleLibraryTable();
  final Collection<Library> librariesToRemove=new ArrayList<Library>();
  for (Iterator<Library> libraryIterator=libraryTable.getLibraryIterator(); libraryIterator.hasNext(); ) {
    final Library library=libraryIterator.next();
    if (isAutogeneratedLibrary(library)) {
      if (createAutogeneratedLibraryFor(flexSdk) && suggestAutogeneratedLibraryName(flexSdk).equals(library.getName())) {
        autogeneratedLibraryEqualToFlexSdk=library;
      }
 else {
        librariesToRemove.add(library);
      }
    }
  }
  for (  final Library library : librariesToRemove) {
    libraryTable.removeLibrary(library);
  }
  if (createAutogeneratedLibraryFor(flexSdk)) {
    if (autogeneratedLibraryEqualToFlexSdk == null) {
      autogeneratedLibraryEqualToFlexSdk=libraryTable.createLibrary(suggestAutogeneratedLibraryName(flexSdk));
    }
    makeLibraryEqualToSdk(autogeneratedLibraryEqualToFlexSdk,flexSdk);
  }
}
