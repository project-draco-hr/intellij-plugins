{
  sendPriorityCommand(getCommandObject("getLibraries"),new AbstractResponseToRequestHandler<JsonResponse>(){
    @Override public boolean processResponse(    JsonResponse response){
      if (response.getJsonObject().get("error") != null) {
        runnable.run();
        return true;
      }
      JsonArray libraries=response.getJsonObject().getAsJsonObject("result").getAsJsonArray("libraries");
      Iterator<JsonElement> iterator=libraries.iterator();
      if (!iterator.hasNext()) {
        runnable.run();
        return true;
      }
      while (iterator.hasNext()) {
        JsonElement library=iterator.next();
        int id=library.getAsJsonObject().get("id").getAsInt();
        String url=library.getAsJsonObject().get("url").getAsString();
        if (url != null && !CORE_LIBS.contains(url)) {
          sendEnableLibrary(id,iterator.hasNext() ? null : new AbstractResponseToRequestHandler<JsonResponse>(){
            @Override public boolean processResponse(            JsonResponse response){
              runnable.run();
              return true;
            }
          }
);
        }
      }
      return true;
    }
  }
);
}
