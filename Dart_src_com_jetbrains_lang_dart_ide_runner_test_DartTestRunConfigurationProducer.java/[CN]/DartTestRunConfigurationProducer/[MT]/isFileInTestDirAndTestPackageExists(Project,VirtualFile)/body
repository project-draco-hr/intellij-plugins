{
  final DartUrlResolver urlResolver=DartUrlResolver.getInstance(project,file);
  final VirtualFile dartTestLib=urlResolver.findFileByDartUrl("package:test/test.dart");
  if (dartTestLib == null)   return false;
  final VirtualFile yamlFile=urlResolver.getPubspecYamlFile();
  if (yamlFile != null) {
    final VirtualFile parent=yamlFile.getParent();
    final VirtualFile testFolder=parent == null ? null : parent.findChild("test");
    if (testFolder == null || !testFolder.isDirectory() || !VfsUtilCore.isAncestor(testFolder,file,true)) {
      return false;
    }
  }
  return true;
}
