{
  final VirtualFile installFolder=getLocalFileSystem().findFileByPath(frameworkInstanceDefinition.getBaseFolder());
  final ArrayList<VirtualFile> directoriesToAdd=new ArrayList<VirtualFile>();
  if (installFolder == null) {
    LOG.warn("The folder " + frameworkInstanceDefinition.getBaseFolder() + " does not exist.");
    return;
  }
  if (!installFolder.isDirectory()) {
    LOG.warn(frameworkInstanceDefinition.getBaseFolder() + " is not a folder");
    return;
  }
  directoriesToAdd.add(installFolder);
  VirtualFile binFolder=installFolder.findChild("bin");
  if (binFolder != null) {
    if (!binFolder.isDirectory()) {
      LOG.warn("The Felix bin-Folder is not a directory.");
    }
 else {
      directoriesToAdd.add(binFolder);
    }
  }
  VirtualFile bundleFolder=installFolder.findChild("bundle");
  if (bundleFolder != null) {
    if (!bundleFolder.isDirectory()) {
      LOG.warn("The Felix bundle-folder is not a directory");
    }
 else {
      directoriesToAdd.add(bundleFolder);
    }
  }
  myApplication.runWriteAction(new Runnable(){
    public void run(){
      installFolder.refresh(false,true);
      collector.collectFrameworkLibraries(myFelixsourcefinder,directoriesToAdd);
    }
  }
);
}
