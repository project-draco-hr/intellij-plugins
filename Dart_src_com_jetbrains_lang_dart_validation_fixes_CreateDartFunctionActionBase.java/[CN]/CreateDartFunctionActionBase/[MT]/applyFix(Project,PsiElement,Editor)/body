{
  final TemplateManager templateManager=TemplateManager.getInstance(project);
  Template template=templateManager.createTemplate("","");
  template.setToReformat(true);
  if (!buildTemplate(template,psiElement)) {
    return;
  }
  PsiElement anchor=findAnchor(psiElement);
  if (anchor == null) {
    CommonRefactoringUtil.showErrorHint(project,editor,DartBundle.message("dart.create.function.intention.family"),DartBundle.message("dart.cannot.find.place.to.create"),null);
    return;
  }
  VirtualFile file=anchor.getContainingFile().getVirtualFile();
  final Editor openedEditor=file == null ? null : navigate(project,file,anchor.getTextOffset());
  if (openedEditor != null) {
    templateManager.startTemplate(openedEditor,template);
  }
}
