{
  final Project project=context.getProject();
  final RunnerAndConfigurationSettings settings=cloneTemplateConfiguration(project,context);
  final CucumberJavaRunConfiguration configuration=(CucumberJavaRunConfiguration)settings.getConfiguration();
  final VirtualFile file=getFileToRun();
  final String glue=getGlue();
  configuration.setProgramParameters(file.getPath() + glue + FORMATTER_OPTIONS);
  if (StringUtil.isEmpty(configuration.MAIN_CLASS_NAME)) {
    configuration.MAIN_CLASS_NAME=CUCUMBER_MAIN_CLASS;
  }
  configuration.setName(getName());
  processConfiguration(configuration);
  setupConfigurationModule(context,configuration);
  JavaRunConfigurationExtensionManager.getInstance().extendCreatedConfiguration(configuration,location);
  return settings;
}
