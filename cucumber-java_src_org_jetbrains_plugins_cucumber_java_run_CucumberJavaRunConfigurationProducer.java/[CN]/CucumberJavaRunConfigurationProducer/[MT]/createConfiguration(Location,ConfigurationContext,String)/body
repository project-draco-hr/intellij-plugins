{
  final Project project=context.getProject();
  final RunnerAndConfigurationSettings settings=cloneTemplateConfiguration(project,context);
  final CucumberJavaRunConfiguration configuration=(CucumberJavaRunConfiguration)settings.getConfiguration();
  final VirtualFile file=getFileToRun();
  if (StringUtil.isEmpty(configuration.getGlue())) {
    final NullableComputable<String> glue=getGlue();
    configuration.setGlue(glue);
  }
  configuration.setFilePath(file.getPath());
  configuration.setProgramParameters(FORMATTER_OPTIONS);
  if (StringUtil.isEmpty(configuration.MAIN_CLASS_NAME)) {
    configuration.MAIN_CLASS_NAME=mainClassName;
  }
  configuration.setName(getName());
  processConfiguration(configuration);
  setupConfigurationModule(context,configuration);
  JavaRunConfigurationExtensionManager.getInstance().extendCreatedConfiguration(configuration,location);
  return settings;
}
