{
  int originalPos=in.position();
  in.seek(start);
  int end=start + length;
  w:   while (in.position() < end) {
    int pos=in.position();
    int opcode=in.readU8();
    if (opcode == OP_label) {
      addTarget(pos);
    }
    if (targetSetExists && targetSet.contains(pos)) {
      v.target(pos);
    }
switch (opcode) {
case OP_ifnlt:
{
        int offset=in.readS24();
        addTarget(offset + in.position());
        v.OP_ifnlt(offset,in.position());
        continue;
      }
case OP_ifnle:
{
      int offset=in.readS24();
      addTarget(offset + in.position());
      v.OP_ifnle(offset,in.position());
      continue;
    }
case OP_ifngt:
{
    int offset=in.readS24();
    addTarget(offset + in.position());
    v.OP_ifngt(offset,in.position());
    continue;
  }
case OP_ifnge:
{
  int offset=in.readS24();
  addTarget(offset + in.position());
  v.OP_ifnge(offset,in.position());
  continue;
}
case OP_pushscope:
v.OP_pushscope();
continue;
case OP_newactivation:
v.OP_newactivation();
continue;
case OP_newcatch:
{
v.OP_newcatch(in.readU32());
continue;
}
case OP_deldescendants:
{
v.OP_deldescendants();
continue;
}
case OP_getglobalscope:
{
v.OP_getglobalscope();
continue;
}
case OP_getlocal0:
v.OP_getlocal0();
continue;
case OP_getlocal1:
v.OP_getlocal1();
continue;
case OP_getlocal2:
v.OP_getlocal2();
continue;
case OP_getlocal3:
v.OP_getlocal3();
continue;
case OP_setlocal0:
v.OP_setlocal0();
continue;
case OP_setlocal1:
v.OP_setlocal1();
continue;
case OP_setlocal2:
v.OP_setlocal2();
continue;
case OP_setlocal3:
v.OP_setlocal3();
continue;
case OP_returnvoid:
v.OP_returnvoid();
continue;
case OP_returnvalue:
v.OP_returnvalue();
continue;
case OP_nop:
v.OP_nop();
continue;
case OP_bkpt:
v.OP_bkpt();
continue;
case OP_timestamp:
v.OP_timestamp();
continue;
case OP_debugline:
v.OP_debugline(in.readU32());
continue;
case OP_bkptline:
in.readU32();
v.OP_bkptline();
continue;
case OP_debug:
{
int di_local=in.readU8();
int index=in.readU32();
int slot=in.readU8();
int linenum=in.readU32();
v.OP_debug(di_local,index,slot,linenum);
continue;
}
case OP_debugfile:
v.OP_debugfile(in);
continue;
case OP_jump:
{
int jump=in.readS24();
addTarget(jump + in.position());
v.OP_jump(jump,in.position());
continue;
}
case OP_pushnull:
v.OP_pushnull();
continue;
case OP_pushundefined:
v.OP_pushundefined();
continue;
case OP_pushstring:
v.OP_pushstring(in.readU32());
continue;
case OP_pushnamespace:
v.OP_pushnamespace(in.readU32());
continue;
case OP_pushint:
v.OP_pushint(in.readU32());
continue;
case OP_pushuint:
v.OP_pushuint(in.readU32());
continue;
case OP_pushdouble:
v.OP_pushdouble(in.readU32());
continue;
case OP_getlocal:
v.OP_getlocal(in.readU32());
continue;
case OP_pushtrue:
v.OP_pushtrue();
continue;
case OP_pushfalse:
v.OP_pushfalse();
continue;
case OP_pushnan:
{
v.OP_pushnan();
continue;
}
case OP_pushdnan:
{
v.OP_pushdnan();
continue;
}
case OP_pop:
{
v.OP_pop();
continue;
}
case OP_dup:
{
v.OP_dup();
continue;
}
case OP_swap:
{
v.OP_swap();
continue;
}
case OP_convert_s:
{
v.OP_convert_s();
continue;
}
case OP_esc_xelem:
{
v.OP_esc_xelem();
continue;
}
case OP_esc_xattr:
{
v.OP_esc_xattr();
continue;
}
case OP_checkfilter:
v.OP_checkfilter();
continue;
case OP_convert_d:
v.OP_convert_d();
continue;
case OP_convert_b:
{
v.OP_convert_b();
continue;
}
case OP_convert_o:
{
v.OP_convert_o();
continue;
}
case OP_convert_m:
{
v.OP_convert_m();
continue;
}
case OP_convert_m_p:
{
v.OP_convert_m_p(in.readU32());
continue;
}
case OP_negate:
{
v.OP_negate();
continue;
}
case OP_negate_p:
{
v.OP_negate_p(in.readU32());
continue;
}
case OP_negate_i:
{
v.OP_negate_i();
continue;
}
case OP_increment:
{
v.OP_increment();
continue;
}
case OP_increment_p:
{
v.OP_increment_p(in.readU32());
continue;
}
case OP_increment_i:
{
v.OP_increment_i();
continue;
}
case OP_inclocal:
{
v.OP_inclocal(in.readU32());
continue;
}
case OP_inclocal_p:
{
v.OP_inclocal_p(in.readU32(),in.readU32());
continue;
}
case OP_kill:
{
v.OP_kill(in.readU32());
continue;
}
case OP_label:
{
v.OP_label();
continue;
}
case OP_inclocal_i:
{
v.OP_inclocal_i(in.readU32());
continue;
}
case OP_decrement:
{
v.OP_decrement();
continue;
}
case OP_decrement_p:
{
int param=in.readU32();
v.OP_decrement_p(param);
continue;
}
case OP_decrement_i:
{
v.OP_decrement_i();
continue;
}
case OP_declocal:
{
int index=in.readU32();
v.OP_declocal(index);
continue;
}
case OP_declocal_p:
{
v.OP_declocal_p(in.readU32(),in.readU32());
continue;
}
case OP_declocal_i:
{
v.OP_declocal_i(in.readU32());
continue;
}
case OP_typeof:
{
v.OP_typeof();
continue;
}
case OP_not:
{
v.OP_not();
continue;
}
case OP_bitnot:
{
v.OP_bitnot();
continue;
}
case OP_setlocal:
{
int index=in.readU32();
v.OP_setlocal(index);
continue;
}
case OP_add:
{
v.OP_add();
continue;
}
case OP_add_p:
{
int param=in.readU32();
v.OP_add_p(param);
continue;
}
case OP_add_i:
{
v.OP_add_i();
continue;
}
case OP_subtract:
{
v.OP_subtract();
continue;
}
case OP_subtract_p:
{
int param=in.readU32();
v.OP_subtract_p(param);
continue;
}
case OP_subtract_i:
{
v.OP_subtract_i();
continue;
}
case OP_multiply:
{
v.OP_multiply();
continue;
}
case OP_multiply_p:
{
int param=in.readU32();
v.OP_multiply_p(param);
continue;
}
case OP_multiply_i:
{
v.OP_multiply_i();
continue;
}
case OP_divide:
{
v.OP_divide();
continue;
}
case OP_divide_p:
{
v.OP_divide_p(in.readU32());
continue;
}
case OP_modulo:
{
v.OP_modulo();
continue;
}
case OP_modulo_p:
{
v.OP_modulo_p(in.readU32());
continue;
}
case OP_lshift:
{
v.OP_lshift();
continue;
}
case OP_rshift:
{
v.OP_rshift();
continue;
}
case OP_urshift:
{
v.OP_urshift();
continue;
}
case OP_bitand:
{
v.OP_bitand();
continue;
}
case OP_bitor:
{
v.OP_bitor();
continue;
}
case OP_bitxor:
{
v.OP_bitxor();
continue;
}
case OP_equals:
{
v.OP_equals();
continue;
}
case OP_strictequals:
{
v.OP_strictequals();
continue;
}
case OP_lookupswitch:
{
int opPos=in.position() - 1;
int defaultPos=in.readS24();
addTarget(defaultPos + opPos);
int size_1=in.readU32();
int[] casePos=new int[size_1 + 1];
int caseTablePos=in.position();
for (int i=0, size=casePos.length; i < size; i++) {
casePos[i]=in.readS24();
addTarget(casePos[i] + opPos);
}
v.OP_lookupswitch(defaultPos,casePos,opPos,caseTablePos);
continue;
}
case OP_iftrue:
{
int offset=in.readS24();
addTarget(offset + in.position());
v.OP_iftrue(offset,in.position());
continue;
}
case OP_iffalse:
{
int offset=in.readS24();
addTarget(offset + in.position());
v.OP_iffalse(offset,in.position());
continue;
}
case OP_ifeq:
{
int offset=in.readS24();
addTarget(offset + in.position());
v.OP_ifeq(offset,in.position());
continue;
}
case OP_ifne:
{
int offset=in.readS24();
addTarget(offset + in.position());
v.OP_ifne(offset,in.position());
continue;
}
case OP_ifstricteq:
{
int offset=in.readS24();
addTarget(offset + in.position());
v.OP_ifstricteq(offset,in.position());
continue;
}
case OP_ifstrictne:
{
int offset=in.readS24();
addTarget(offset + in.position());
v.OP_ifstrictne(offset,in.position());
continue;
}
case OP_iflt:
{
int offset=in.readS24();
addTarget(offset + in.position());
v.OP_iflt(offset,in.position());
continue;
}
case OP_ifle:
{
int offset=in.readS24();
addTarget(offset + in.position());
v.OP_ifle(offset,in.position());
continue;
}
case OP_ifgt:
{
int offset=in.readS24();
addTarget(offset + in.position());
v.OP_ifgt(offset,in.position());
continue;
}
case OP_ifge:
{
int offset=in.readS24();
addTarget(offset + in.position());
v.OP_ifge(offset,in.position());
continue;
}
case OP_lessthan:
{
v.OP_lessthan();
continue;
}
case OP_lessequals:
{
v.OP_lessequals();
continue;
}
case OP_greaterthan:
{
v.OP_greaterthan();
continue;
}
case OP_greaterequals:
{
v.OP_greaterequals();
continue;
}
case OP_newobject:
{
v.OP_newobject(in.readU32());
continue;
}
case OP_newarray:
{
v.OP_newarray(in.readU32());
continue;
}
case OP_getproperty:
{
v.OP_getproperty(in.readU32());
continue;
}
case OP_setproperty:
{
v.OP_setproperty(in.readU32());
continue;
}
case OP_initproperty:
{
v.OP_initproperty(in.readU32());
continue;
}
case OP_getdescendants:
{
v.OP_getdescendants(in.readU32());
continue;
}
case OP_findpropstrict:
{
v.OP_findpropstrict(in.readU32());
continue;
}
case OP_getlex:
{
v.OP_getlex(in.readU32());
continue;
}
case OP_findproperty:
{
v.OP_findproperty(in.readU32());
continue;
}
case OP_finddef:
{
v.OP_finddef(in.readU32());
continue;
}
case OP_nextname:
{
v.OP_nextname();
continue;
}
case OP_nextvalue:
{
v.OP_nextvalue();
continue;
}
case OP_hasnext:
{
v.OP_hasnext();
continue;
}
case OP_hasnext2:
{
v.OP_hasnext2(in.readU32(),in.readU32());
continue;
}
case OP_deleteproperty:
{
v.OP_deleteproperty(in.readU32());
continue;
}
case OP_setslot:
{
v.OP_setslot(in.readU32());
continue;
}
case OP_getslot:
{
v.OP_getslot(in.readU32());
continue;
}
case OP_setglobalslot:
{
v.OP_setglobalslot(in.readU32());
continue;
}
case OP_getglobalslot:
{
v.OP_getglobalslot(in.readU32());
continue;
}
case OP_call:
{
v.OP_call(in.readU32());
continue;
}
case OP_construct:
{
v.OP_construct(in.readU32());
continue;
}
case OP_applytype:
{
v.OP_applytype(in.readU32());
continue;
}
case OP_newfunction:
{
v.OP_newfunction(in.readU32());
continue;
}
case OP_newclass:
{
v.OP_newclass(in.readU32());
continue;
}
case OP_callstatic:
{
v.OP_callstatic(in.readU32(),in.readU32());
continue;
}
case OP_callmethod:
{
v.OP_callmethod(in.readU32(),in.readU32());
continue;
}
case OP_callproperty:
{
v.OP_callproperty(in.readU32(),in.readU32());
continue;
}
case OP_callproplex:
{
v.OP_callproplex(in.readU32(),in.readU32());
continue;
}
case OP_constructprop:
{
v.OP_constructprop(in.readU32(),in.readU32());
continue;
}
case OP_callsuper:
{
v.OP_callsuper(in.readU32(),in.readU32());
continue;
}
case OP_getsuper:
{
v.OP_getsuper(in.readU32());
continue;
}
case OP_setsuper:
{
v.OP_setsuper(in.readU32());
continue;
}
case OP_constructsuper:
v.OP_constructsuper(in.readU32());
if (stopAfterConstructSuper) {
v.OP_returnvoid();
break w;
}
continue;
case OP_pushshort:
{
int n=in.readU32();
v.OP_pushshort(n);
continue;
}
case OP_astype:
{
v.OP_astype(in.readU32());
continue;
}
case OP_astypelate:
v.OP_astypelate();
continue;
case OP_coerce:
{
v.OP_coerce(in.readU32());
continue;
}
case OP_coerce_b:
{
v.OP_coerce_b();
continue;
}
case OP_coerce_o:
{
v.OP_coerce_o();
continue;
}
case OP_coerce_a:
{
v.OP_coerce_a();
continue;
}
case OP_coerce_i:
{
v.OP_coerce_i();
continue;
}
case OP_coerce_u:
{
v.OP_coerce_u();
continue;
}
case OP_coerce_d:
{
v.OP_coerce_d();
continue;
}
case OP_coerce_s:
{
v.OP_coerce_s();
continue;
}
case OP_istype:
{
v.OP_istype(in.readU32());
continue;
}
case OP_istypelate:
{
v.OP_istypelate();
continue;
}
case OP_pushbyte:
{
v.OP_pushbyte(in.readU8());
continue;
}
case OP_getscopeobject:
{
v.OP_getscopeobject(in.readU8());
continue;
}
case OP_pushwith:
{
v.OP_pushwith();
continue;
}
case OP_popscope:
{
v.OP_popscope();
continue;
}
case OP_convert_i:
{
v.OP_convert_i();
continue;
}
case OP_convert_u:
{
v.OP_convert_u();
continue;
}
case OP_throw:
{
v.OP_throw();
continue;
}
case OP_instanceof:
{
v.OP_instanceof();
continue;
}
case OP_in:
{
v.OP_in();
continue;
}
case OP_dxns:
{
v.OP_dxns(in.readU32());
continue;
}
case OP_dxnslate:
{
v.OP_dxnslate();
continue;
}
case OP_pushuninitialized:
{
v.OP_pushconstant(in.readU32());
continue;
}
case OP_callsupervoid:
{
v.OP_callsupervoid(in.readU32(),in.readU32());
continue;
}
case OP_callpropvoid:
{
v.OP_callpropvoid(in.readU32(),in.readU32());
continue;
}
case OP_li8:
{
v.OP_li8();
continue;
}
case OP_li16:
{
v.OP_li16();
continue;
}
case OP_li32:
{
v.OP_li32();
continue;
}
case OP_lf32:
{
v.OP_lf32();
continue;
}
case OP_lf64:
{
v.OP_lf64();
continue;
}
case OP_si8:
{
v.OP_si8();
continue;
}
case OP_si16:
{
v.OP_si16();
continue;
}
case OP_si32:
{
v.OP_si32();
continue;
}
case OP_sf32:
{
v.OP_sf32();
continue;
}
case OP_sf64:
{
v.OP_sf64();
continue;
}
case OP_sxi1:
{
v.OP_sxi1();
continue;
}
case OP_sxi8:
{
v.OP_sxi8();
continue;
}
case OP_sxi16:
{
v.OP_sxi16();
continue;
}
default :
{
throw new DecoderException("unknown opcode:" + opcode);
}
}
}
in.seek(originalPos);
}
