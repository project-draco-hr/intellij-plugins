{
  long startTimeNano=System.nanoTime();
  @SuppressWarnings({"unchecked"}) RunSettingsContext runSettingsContext=buildRunSettingsContext(location);
  if (runSettingsContext == null) {
    logDoneCreateConfigurationByElement(startTimeNano,"1");
    return null;
  }
  final RunnerAndConfigurationSettings runnerSettings=cloneTemplateConfiguration(location.getProject(),context);
  JstdRunConfiguration runConfiguration=ObjectUtils.tryCast(runnerSettings.getConfiguration(),JstdRunConfiguration.class);
  if (runConfiguration == null) {
    logDoneCreateConfigurationByElement(startTimeNano,"2");
    return null;
  }
  JstdRunSettings settings=runSettingsContext.myRunSettings;
  if (settings.getConfigFile().isEmpty()) {
    JstdRunSettings clonedSettings=runConfiguration.getRunSettings();
    JstdRunSettings.Builder builder=new JstdRunSettings.Builder(settings);
    builder.setConfigFile(clonedSettings.getConfigFile());
    settings=builder.build();
  }
  runConfiguration.setRunSettings(settings);
  mySourceElement=runSettingsContext.myPsiElement;
  runnerSettings.setName(runConfiguration.suggestedName());
  logDoneCreateConfigurationByElement(startTimeNano,"3");
  return runnerSettings;
}
