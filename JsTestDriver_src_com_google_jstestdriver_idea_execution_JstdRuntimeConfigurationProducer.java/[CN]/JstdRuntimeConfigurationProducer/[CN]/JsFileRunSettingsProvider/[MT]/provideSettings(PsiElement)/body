{
  PsiFile psiFile=psiElement.getContainingFile();
  if (psiFile == null) {
    return null;
  }
  final VirtualFile virtualFile=psiFile.getVirtualFile();
  if (virtualFile == null || virtualFile.getFileType() != JavaScriptSupportLoader.JAVASCRIPT) {
    return null;
  }
  VirtualFile entity=virtualFile;
  VirtualFile projectDir=psiElement.getProject().getBaseDir();
  boolean testFound=false;
  while (entity != null) {
    if (matchTestSource(entity.getName())) {
      testFound=true;
    }
    if (entity.equals(projectDir)) {
      break;
    }
    entity=entity.getParent();
  }
  if (Comparing.equal(entity,projectDir) && testFound) {
    JstdRunSettings.Builder builder=new JstdRunSettings.Builder();
    builder.setTestType(TestType.JS_FILE);
    builder.setConfigType(JstdConfigType.GENERATED);
    builder.setJSFilePath(virtualFile.getPath());
    builder.setServerType(ServerType.INTERNAL);
    return builder.build();
  }
  return null;
}
