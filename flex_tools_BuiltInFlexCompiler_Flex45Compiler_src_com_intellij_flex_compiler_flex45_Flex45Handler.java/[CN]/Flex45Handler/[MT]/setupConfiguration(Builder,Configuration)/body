{
  final flex2.tools.oem.Configuration oemConfig=builder.getDefaultConfiguration();
  populateDefaults(oemConfig,(ToolsConfiguration)configuration);
  final StringBuilder defaultsCssFiles=new StringBuilder();
  for (  VirtualFile file : configuration.getCompilerConfiguration().getDefaultsCssFiles()) {
    if (defaultsCssFiles.length() > 0)     defaultsCssFiles.insert(0,',');
    defaultsCssFiles.insert(0,file.getName());
  }
  final List<String> extras=new ArrayList<String>();
  extras.add("-defaults-css-files=" + defaultsCssFiles.toString());
  extras.add("-omit-trace-statements=" + configuration.getCompilerConfiguration().omitTraceStatements());
  extras.add("-swf-version=" + configuration.getSwfVersion());
  final String preloader=configuration.getCompilerConfiguration().getPreloader();
  if (preloader != null) {
    extras.add("-preloader=" + preloader);
  }
  extras.add("-load-config=");
  oemConfig.setConfiguration(extras.toArray(new String[extras.size()]));
  builder.setConfiguration(oemConfig);
}
