{
  if (_bundleManifest == null) {
    if (_library instanceof LibraryEx && ((LibraryEx)_library).isDisposed()) {
      return _bundleManifest;
    }
    VirtualFile[] classRoots=_library.getFiles(OrderRootType.CLASSES);
    for (    VirtualFile classRoot : classRoots) {
      VirtualFile classDir;
      if (classRoot.isDirectory()) {
        classDir=classRoot;
      }
 else {
        classDir=JarFileSystem.getInstance().getJarRootForLocalFile(classRoot);
      }
      if (classDir != null) {
        final VirtualFile manifestFile=classDir.findFileByRelativePath("META-INF/MANIFEST.MF");
        if (manifestFile != null) {
          PsiFile psiFile=new ReadAction<PsiFile>(){
            @Override protected void run(            Result<PsiFile> psiFileResult) throws Throwable {
              psiFileResult.setResult(PsiManager.getInstance(_project).findFile(manifestFile));
            }
          }
.execute().getResultObject();
          _bundleManifest=new BundleManifestImpl(psiFile);
        }
      }
    }
  }
  return _bundleManifest;
}
