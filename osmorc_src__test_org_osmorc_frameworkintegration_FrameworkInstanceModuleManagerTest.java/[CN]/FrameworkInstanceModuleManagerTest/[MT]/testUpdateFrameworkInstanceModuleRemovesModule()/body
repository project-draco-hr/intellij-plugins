{
  expect(osmorcFacetUtil.hasOsmorcFacet(EasyMock.not(same(module)))).andReturn(false).anyTimes();
  expect(osmorcFacetUtil.hasOsmorcFacet(same(module))).andReturn(true).once();
  expect(osmorcFacetUtil.hasOsmorcFacet(same(module))).andReturn(false).once();
  replay(osmorcFacetUtil);
  projectSettings.setCreateFrameworkInstanceModule(true);
  projectSettings.setFrameworkInstanceName("an Instance");
  testObject.updateFrameworkInstanceModule();
  module=ModuleManager.getInstance(project).findModuleByName(FrameworkInstanceModuleManager.FRAMEWORK_INSTANCE_MODULE_NAME);
  assertThat(module,notNullValue());
  testObject.updateFrameworkInstanceModule();
  Module module=ModuleManager.getInstance(project).findModuleByName(FrameworkInstanceModuleManager.FRAMEWORK_INSTANCE_MODULE_NAME);
  assertThat(module,nullValue());
  verify(osmorcFacetUtil);
}
