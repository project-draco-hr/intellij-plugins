{
  if (!CodeInsightSettings.getInstance().AUTOINSERT_PAIR_BRACKET)   return TypedHandlerDelegate.Result.DEFAULT;
  if (file.getFileType() == HtmlFileType.INSTANCE) {
    if (c == '{') {
      boolean addWhiteSpaceBetweenBraces=AngularJSConfig.getInstance().INSERT_WHITESPACE;
      int offset=editor.getCaretModel().getOffset();
      String chars=editor.getDocument().getText();
      if (offset > 0 && (chars.charAt(offset - 1)) == '{') {
        if (offset < 2 || (chars.charAt(offset - 2)) != '{') {
          if (alreadyHasEnding(chars,offset)) {
            return TypedHandlerDelegate.Result.CONTINUE;
          }
 else {
            String interpolation;
            if (addWhiteSpaceBetweenBraces) {
              interpolation="{  }";
            }
 else {
              interpolation="{}";
            }
            if (offset == chars.length() || (offset < chars.length() && chars.charAt(offset) != '}')) {
              interpolation+="}";
            }
            EditorModificationUtil.typeInStringAtCaretHonorBlockSelection(editor,interpolation,true);
            editor.getCaretModel().moveToOffset(offset + (addWhiteSpaceBetweenBraces ? 2 : 1));
            return Result.STOP;
          }
        }
      }
    }
  }
  return TypedHandlerDelegate.Result.CONTINUE;
}
