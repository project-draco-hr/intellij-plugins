{
  clientRequest.retain();
  if (processHandler.has()) {
    sendToServer(servedDir,clientContext,clientRequest,pathForPubServer);
  }
 else {
    firstServedDir=servedDir;
    processHandler.get().doWhenDone(new Runnable(){
      @Override public void run(){
        sendToServer(servedDir,clientContext,clientRequest,pathForPubServer);
      }
    }
).doWhenRejected(new Runnable(){
      @Override public void run(){
        sendBadGateway(clientContext.channel());
      }
    }
);
  }
}
