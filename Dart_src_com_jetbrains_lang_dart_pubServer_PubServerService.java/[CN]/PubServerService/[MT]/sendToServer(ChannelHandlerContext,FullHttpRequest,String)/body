{
  final Attribute<Channel> serverChannelAttribute=clientContext.attr(SERVER_CHANNEL_KEY);
  Channel serverChannel=serverChannelAttribute.get();
  if (serverChannel == null) {
    serverChannel=findFreeServerChannel();
    if (serverChannel != null) {
      serverChannelAttribute.set(serverChannel);
    }
  }
  if (serverChannel == null) {
    connect(bootstrap,serverAddress,new Consumer<Channel>(){
      @Override public void consume(      final Channel serverChannel){
        if (serverChannel == null) {
          sendBadGateway(clientContext.channel());
        }
 else {
          serverChannelAttribute.set(serverChannel);
          serverChannel.closeFuture().addListener(serverChannelCloseListener);
          ChannelHandlerContext oldClientContext=serverToClientContext.put(serverChannel,clientContext);
          LOG.assertTrue(oldClientContext == null);
          clientContext.channel().pipeline().addLast(clientChannelStateHandler);
          sendToServer(clientRequest,pathToPubServe,serverChannel);
        }
      }
    }
);
  }
 else {
    sendToServer(clientRequest,pathToPubServe,serverChannel);
  }
}
