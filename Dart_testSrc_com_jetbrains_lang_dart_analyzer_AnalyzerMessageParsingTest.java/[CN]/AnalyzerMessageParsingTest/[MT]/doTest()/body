{
  final String name=getTestName(true);
  final String[] lines=StringUtil.splitByLines(FileUtil.loadFile(new File(getTestDataPath(),name + ".stdout.txt")));
  final List<AnalyzerMessage> messageList=AnalyzerMessage.parseMessages(Arrays.asList(lines),"unused");
  final File expected=new File(getTestDataPath(),name + ".txt");
  if (!expected.exists()) {
    final PrintWriter out=new PrintWriter(new FileOutputStream(expected));
    try {
      for (      AnalyzerMessage message : messageList) {
        out.println(message.toString());
      }
    }
  finally {
      out.close();
    }
    assertNotNull("Expected file not found. Create: " + expected.getAbsolutePath(),null);
  }
  final Scanner in=new Scanner(expected);
  int i=0;
  for (int size=messageList.size(); i < size; i++) {
    AnalyzerMessage message=messageList.get(i);
    assertEquals(in.nextLine(),message.toString());
  }
  assertEquals(messageList.size(),i);
}
