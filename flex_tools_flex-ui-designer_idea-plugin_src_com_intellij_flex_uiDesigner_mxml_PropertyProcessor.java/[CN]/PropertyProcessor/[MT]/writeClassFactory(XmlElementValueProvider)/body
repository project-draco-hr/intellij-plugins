{
  if (valueProvider instanceof XmlTagValueProvider) {
    XmlTag tag=((XmlTagValueProvider)valueProvider).getTag();
    XmlTag[] subTags=tag.getSubTags();
    if (subTags.length > 0) {
      throw new InvalidPropertyException(tag,"error.inline.component.are.not.supported");
    }
  }
  String className=valueProvider.getTrimmed();
  if (writeReferenceIfReferenced(className)) {
    return;
  }
  JSClass jsClass=valueProvider.getJsClass();
  if (jsClass == null) {
    throw new InvalidPropertyException(valueProvider.getElement(),"error.unresolved.class",valueProvider.getTrimmed());
  }
  final int projectComponentFactoryId=getProjectComponentFactoryId(jsClass);
  if (projectComponentFactoryId == -1) {
    writeNonProjectUnreferencedClassFactory(className);
  }
 else {
    writer.documentFactoryReference(projectComponentFactoryId);
  }
}
