{
  VirtualFile file=FileDocumentManager.getInstance().getFile(document);
  if (file == null) {
    return;
  }
  int id=files.indexOf(file);
  if (id == -1) {
    return;
  }
  FlexUIDesignerApplicationManager flexUIDesignerApplicationManager=FlexUIDesignerApplicationManager.getInstance();
  if (flexUIDesignerApplicationManager.isDocumentOpening()) {
    return;
  }
  Module module=ModuleUtil.findModuleForFile(file,myProject);
  if (module == null) {
    return;
  }
  XmlFile psiFile=(XmlFile)PsiDocumentManager.getInstance(myProject).getPsiFile(document);
  if (psiFile == null) {
    return;
  }
  flexUIDesignerApplicationManager.updateDocumentFactory(id,module,psiFile);
}
