{
  final FileOutputStream out=transcode(inputStream,inputLength,outFile);
  try {
    extract();
    buffer.position(0);
    writePartialHeader(fileLength);
    out.write(buffer.array(),0,fileAttributesEndPosition);
    writeUsedPlacedObjects(out);
  }
  finally {
    out.flush();
    out.close();
  }
}
