{
  final List<VirtualFile> expanded=new ArrayList<VirtualFile>();
  for (  VirtualFile file : rootFiles) {
    if (file.isDirectory()) {
      if (jarDirectories.contains(rootType,file.getUrl())) {
        LibraryImpl.collectJarFiles(file,expanded,jarDirectories.isRecursive(rootType,file.getUrl()));
        continue;
      }
    }
    expanded.add(file);
  }
  return VfsUtil.toVirtualFileArray(expanded);
}
