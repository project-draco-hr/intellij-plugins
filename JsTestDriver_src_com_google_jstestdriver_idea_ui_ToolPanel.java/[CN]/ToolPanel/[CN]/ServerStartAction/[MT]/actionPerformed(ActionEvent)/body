{
  CapturedBrowsers browsers=new CapturedBrowsers(new BrowserIdStrategy(new TimeImpl()));
  FileLoader fileLoader=new ProcessingFileLoader(new SimpleFileReader(),Collections.<FileLoadPostProcessor>singleton(new InlineHtmlProcessor(new HtmlDocParser(),new HtmlDocLexer())),new File("."),new NullStopWatch());
  JsTestDriverServer.Factory factory=new DefaultServerFactory(browsers,SlaveBrowser.TIMEOUT,new NullPathPrefix(),Sets.<ServerListener>newHashSet(ToolPanel.this,myStatusBar,myCapturedBrowsersPanel));
  myServerStartupAction=new ServerStartupAction(serverPort,-1,new JstdTestCaseStore(),false,fileLoader,factory);
  myServerStartupAction.run(null);
  final String serverUrl=format("http://{0}:{1,number,###}/capture",InfoPanel.getHostName(),serverPort);
  myCaptureUrl.setText(serverUrl);
}
