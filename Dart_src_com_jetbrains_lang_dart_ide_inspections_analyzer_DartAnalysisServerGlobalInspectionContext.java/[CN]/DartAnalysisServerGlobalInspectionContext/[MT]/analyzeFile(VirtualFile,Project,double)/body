{
  updateIndicator("Analyzing " + virtualFile.getName() + "...",progressFraction);
  final DartServerErrorsAnnotator annotator=new DartServerErrorsAnnotator();
  final DartServerErrorsAnnotator.AnnotatorInfo annotatorInfo=ApplicationManager.getApplication().runReadAction(new NullableComputable<DartServerErrorsAnnotator.AnnotatorInfo>(){
    @Nullable public DartServerErrorsAnnotator.AnnotatorInfo compute(){
      final PsiFile psiFile=PsiManager.getInstance(project).findFile(virtualFile);
      if (psiFile == null)       return null;
      return annotator.collectInformation(psiFile,null,false);
    }
  }
);
  if (annotatorInfo == null)   return;
  annotatorInfo.setLongerAnalysisTimeout(true);
  final AnalysisError[] errors=DartAnalysisServerService.getInstance().analysis_getErrors(annotatorInfo);
  if (errors == null || errors.length == 0)   return;
  myVirtualFile2ErrorsMap.put(virtualFile,errors);
}
