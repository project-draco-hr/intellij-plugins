{
  if (markedText == null) {
    return;
  }
  Pattern p=Pattern.compile("\\$\\{(.+?)\\}");
  Matcher m=p.matcher(markedText);
  int startInd=0;
  do {
    boolean variableFound=m.find();
    final String plainText;
    if (variableFound) {
      plainText=markedText.substring(startInd,m.start());
    }
 else {
      plainText=markedText.substring(startInd);
    }
    fillTemplateWithPlainText(template,plainText);
    if (variableFound) {
      String variableName=m.group(1);
      template.addVariable(variableName.replaceAll(" ","_"),new ConstantNode(variableName),new ConstantNode(variableName),true);
      startInd=m.end();
    }
 else {
      startInd=markedText.length();
    }
  }
 while (startInd < markedText.length());
}
