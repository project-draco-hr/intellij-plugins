{
  final PsiMethod method=p.getMethod();
  final PsiAnnotation stepAnnotation=CucumberJavaUtil.getCucumberAnnotation(method);
  if (stepAnnotation != null) {
    final String regexp=CucumberJavaUtil.getPatternFromStepDefinition(stepAnnotation);
    final String word=org.jetbrains.plugins.cucumber.CucumberUtil.getTheBiggestWordToSearchByIndex(regexp);
    if (StringUtil.isEmpty(word)) {
      return;
    }
    if (p.getScope() instanceof GlobalSearchScope) {
      GlobalSearchScope restrictedScope=GlobalSearchScope.getScopeRestrictedByFileTypes((GlobalSearchScope)p.getScope(),GherkinFileType.INSTANCE);
      ReferencesSearch.search(new ReferencesSearch.SearchParameters(method,restrictedScope,false,p.getOptimizer())).forEach(consumer);
    }
  }
}
