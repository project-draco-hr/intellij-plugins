{
  final ServerExtractMethodRefactoring refactoring=createRefactoring(filePath);
  final RefactoringStatus initialConditions=refactoring.checkInitialConditions();
  assertNotNull(initialConditions);
  assertTrue(initialConditions.isOK());
  refactoring.setName("test");
  refactoring.setExtractAll(all);
  refactoring.setCreateGetter(asGetter);
  final RefactoringStatus finalConditions=refactoring.checkFinalConditions();
  assertNotNull(finalConditions);
  assertTrue(finalConditions.isOK());
  final SourceChange change=refactoring.getChange();
  assertNotNull(change);
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      AssistUtils.applySourceChange(myFixture.getProject(),change);
    }
  }
);
  myFixture.checkResultByFile(getTestName(false) + ".after.dart");
}
