{
  final Pair<Module,VirtualFile> moduleAndPubspecYamlFile=getModuleAndPubspecYamlFile(e);
  if (moduleAndPubspecYamlFile == null)   return;
  DartSdk sdk=DartSdk.getGlobalDartSdk();
  if (sdk == null) {
    final int answer=Messages.showDialog(moduleAndPubspecYamlFile.first.getProject(),"Dart SDK is not configured",getPresentableText(),new String[]{"Configure SDK","Cancel"},0,Messages.getErrorIcon());
    if (answer != 0)     return;
    ShowSettingsUtil.getInstance().showSettingsDialog(moduleAndPubspecYamlFile.first.getProject(),DartBundle.message("dart.title"));
    sdk=DartSdk.getGlobalDartSdk();
    if (sdk == null)     return;
  }
  File pubFile=new File(sdk.getHomePath() + (SystemInfo.isWindows ? "/bin/pub.bat" : "/bin/pub"));
  if (!pubFile.isFile()) {
    final int answer=Messages.showDialog(moduleAndPubspecYamlFile.first.getProject(),DartBundle.message("dart.sdk.bad.dartpub.path",pubFile.getPath()),getPresentableText(),new String[]{"Configure SDK","Cancel"},0,Messages.getErrorIcon());
    if (answer != 0)     return;
    ShowSettingsUtil.getInstance().showSettingsDialog(moduleAndPubspecYamlFile.first.getProject(),DartBundle.message("dart.title"));
    sdk=DartSdk.getGlobalDartSdk();
    if (sdk == null)     return;
    pubFile=new File(sdk.getHomePath() + (SystemInfo.isWindows ? "/bin/pub.bat" : "/bin/pub"));
    if (!pubFile.isFile())     return;
  }
  doExecute(moduleAndPubspecYamlFile.first,moduleAndPubspecYamlFile.second,sdk.getHomePath(),pubFile.getPath());
}
