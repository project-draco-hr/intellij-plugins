{
  FileDocumentManager.getInstance().saveAllDocuments();
  try {
    if (ourInProgress.compareAndSet(false,true)) {
      final OSProcessHandler processHandler=new OSProcessHandler(command);
      processHandler.addProcessListener(new ProcessAdapter(){
        @Override public void processTerminated(        final ProcessEvent event){
          ourInProgress.set(false);
          ApplicationManager.getApplication().invokeLater(new Runnable(){
            public void run(){
              DartProjectComponent.excludePackagesFolders(module,pubspecYamlFile);
              pubspecYamlFile.getParent().refresh(true,true);
            }
          }
);
        }
      }
);
      showPubOutputConsole(module.getProject(),processHandler,pubspecYamlFile,actionTitle);
    }
  }
 catch (  ExecutionException e) {
    ourInProgress.set(false);
    Notifications.Bus.notify(new Notification(GROUP_DISPLAY_ID,actionTitle,DartBundle.message("dart.pub.exception",e.getMessage()),NotificationType.ERROR));
  }
}
