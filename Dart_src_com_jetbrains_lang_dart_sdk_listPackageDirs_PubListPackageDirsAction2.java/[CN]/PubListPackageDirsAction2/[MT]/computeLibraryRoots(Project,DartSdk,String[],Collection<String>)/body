{
  final ProjectFileIndex fileIndex=ProjectRootManager.getInstance(project).getFileIndex();
  final SortedSet<String> folderPaths=new TreeSet<String>();
  for (  final String path : libraries) {
    if (path != null) {
      folderPaths.add(PathUtil.getParentPath(FileUtil.toSystemIndependentName(path)));
    }
  }
  outer:   for (  final String path : folderPaths) {
    final VirtualFile vFile=LocalFileSystem.getInstance().findFileByPath(path);
    if (!path.startsWith(dartSdk.getHomePath() + "/") && (vFile == null || !fileIndex.isInContent(vFile))) {
      for (      String configuredPath : rootsToAddToLib) {
        if (path.startsWith(configuredPath + "/")) {
          continue outer;
        }
      }
      rootsToAddToLib.add(path);
    }
  }
}
