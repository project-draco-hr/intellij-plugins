{
  final String oldPackageWithDot=oldPackageName + ".";
  for (  FlexBuildConfiguration bc : FlexBuildConfigurationManager.getInstance(module).getBuildConfigurations()) {
    if (bc.getOutputType() == OutputType.Application && bc.getMainClass().startsWith(oldPackageWithDot)) {
      final String mainClass=(newPackageName.isEmpty() ? "" : (newPackageName + ".")) + bc.getMainClass().substring(oldPackageWithDot.length());
      FlexProjectConfigurationEditor.makeNonStructuralModification(bc,new Consumer<NonStructuralModifiableBuildConfiguration>(){
        @Override public void consume(        final NonStructuralModifiableBuildConfiguration configuration){
          configuration.setMainClass(mainClass);
        }
      }
);
    }
    if (BCUtils.canHaveRLMsAndRuntimeStylesheets(bc)) {
      final Collection<FlexBuildConfiguration.RLMInfo> oldRLMs=bc.getRLMs();
      final Collection<FlexBuildConfiguration.RLMInfo> newRLMs=new ArrayList<FlexBuildConfiguration.RLMInfo>();
      boolean changed=false;
      for (      FlexBuildConfiguration.RLMInfo rlm : oldRLMs) {
        if (rlm.MAIN_CLASS.startsWith(oldPackageWithDot)) {
          changed=true;
          final String mainClass=(newPackageName.isEmpty() ? "" : (newPackageName + ".")) + rlm.MAIN_CLASS.substring(oldPackageWithDot.length());
          final String outputFileName=rlm.OUTPUT_FILE.equals(BCUtils.suggestRLMOutputPath(rlm.MAIN_CLASS)) ? BCUtils.suggestRLMOutputPath(mainClass) : rlm.OUTPUT_FILE;
          newRLMs.add(new FlexBuildConfiguration.RLMInfo(mainClass,outputFileName,rlm.OPTIMIZE));
        }
 else {
          newRLMs.add(rlm);
        }
      }
      if (changed) {
        FlexProjectConfigurationEditor.makeNonStructuralModification(bc,new Consumer<NonStructuralModifiableBuildConfiguration>(){
          public void consume(          final NonStructuralModifiableBuildConfiguration configuration){
            configuration.setRLMs(newRLMs);
          }
        }
);
      }
    }
  }
}
