{
  changeServiceImplementation(FlexUIDesignerApplicationManager.class,MyFlexUIDesignerApplicationManager.class);
  String testFile=System.getProperty("testFile");
  String[] files=testFile == null ? getTestFiles() : new String[]{getTestPath() + "/" + testFile+ ".mxml"};
  final VirtualFile[] vFiles=new VirtualFile[files.length + 3];
  for (int i=0; i < files.length; i++) {
    vFiles[i]=getVFile(files[i]);
  }
  vFiles[files.length]=getVFile(getTestPath() + "/background.jpg");
  vFiles[files.length + 1]=getVFile(getTestPath() + "/background.p-n-g");
  vFiles[files.length + 2]=getVFile(getTestPath() + "/anim.swf");
  testFiles(vFiles);
  final List<String> problems=((MyFlexUIDesignerApplicationManager)FlexUIDesignerApplicationManager.getInstance()).problems;
  if (testFile != null) {
    assertEquals(0,problems.size());
  }
 else {
    assertEquals(1,problems.size());
    assertEquals("Invalid color name: invalidcolorname",problems.get(0));
  }
}
