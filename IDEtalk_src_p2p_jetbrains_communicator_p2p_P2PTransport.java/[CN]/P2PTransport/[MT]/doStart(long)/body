{
  BuiltInServerManager.getInstance().waitForStart();
  myUserMonitorThread=new UserMonitorThread(this,waitUserResponsesTimeout);
  myUserMonitorThread.start();
  myUserMonitorThread.triggerFindNow();
  new WaitFor(){
    @Override protected boolean condition(){
      return myUserMonitorThread.isRunning();
    }
  }
;
  myEventBroadcaster.addListener(myUserAddedCallbackListener);
  P2PCommand[] commands={new SendXmlMessageP2PCommand(myEventBroadcaster,this),new AddOnlineUserP2PCommand(myUserMonitorThread)};
  Map<String,Object> handlers=CustomPortServerManager.EP_NAME.findExtension(P2PCustomPortServerManager.class).handlers;
  for (  P2PCommand command : commands) {
    handlers.put(command.getXmlRpcId(),command);
  }
}
