{
  final ServerInlineMethodRefactoring refactoring=createRefactoring(filePath,atString);
  final RefactoringStatus initialConditions=refactoring.checkInitialConditions();
  assertNotNull(initialConditions);
  assertTrue(initialConditions.isOK());
  if (all) {
    refactoring.setInlineAll(true);
    refactoring.setDeleteSource(true);
  }
  final RefactoringStatus finalConditions=refactoring.checkFinalConditions();
  assertNotNull(finalConditions);
  assertTrue(finalConditions.isOK());
  final SourceChange change=refactoring.getChange();
  assertNotNull(change);
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      AssistUtils.applySourceChange(myFixture.getProject(),change);
    }
  }
);
  myFixture.checkResultByFile(getTestName(false) + ".after.dart");
}
