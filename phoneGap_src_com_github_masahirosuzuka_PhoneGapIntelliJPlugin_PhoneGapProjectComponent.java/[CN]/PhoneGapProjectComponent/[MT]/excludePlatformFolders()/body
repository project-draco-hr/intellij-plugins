{
  final Collection<VirtualFile> platformsFolders=FilenameIndex.getVirtualFilesByName(myProject,FOLDER_PLATFORMS,GlobalSearchScope.projectScope(myProject));
  for (  VirtualFile platformFolder : platformsFolders) {
    Module module=ModuleUtilCore.findModuleForFile(platformFolder,myProject);
    if (module == null) {
      continue;
    }
    VirtualFile contentRoot=getContentRoot(module,platformFolder);
    if (contentRoot == null)     continue;
    Collection<String> oldExcludedFolders=getOldExcludedFolders(module,platformFolder);
    if (oldExcludedFolders.size() == 1 && oldExcludedFolders.contains(platformFolder.getUrl()))     continue;
    updateExcludedFolders(module,contentRoot,oldExcludedFolders,ContainerUtil.newHashSet(platformFolder.getUrl()));
  }
}
