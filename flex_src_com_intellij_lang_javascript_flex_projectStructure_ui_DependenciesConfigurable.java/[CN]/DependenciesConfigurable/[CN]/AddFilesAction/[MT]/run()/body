{
  LibraryTable.ModifiableModel librariesModel=myModifiableRootModel.getModuleLibraryTable().getModifiableModel();
  Module module=myModifiableRootModel.getModule();
  List<? extends FlexLibraryType> libraryTypes=Collections.singletonList(new FlexLibraryType(){
    @Override public LibraryRootsComponentDescriptor createLibraryRootsComponentDescriptor(){
      return new FlexLibraryRootsComponentDescriptor(){
        @NotNull @Override public List<? extends RootDetector> getRootDetectors(){
          return Arrays.asList(SWC_LIBRARY_DETECTOR);
        }
      }
;
    }
    @NotNull @Override public FlexLibraryProperties createDefaultProperties(){
      return new FlexLibraryProperties(UUID.randomUUID().toString());
    }
  }
);
  CreateModuleLibraryChooser c=new CreateModuleLibraryChooser(libraryTypes,myMainPanel,module,librariesModel);
  try {
    c.doChoose();
    if (!c.isOK()) {
      return;
    }
    final List<Library> libraries=c.getChosenElements();
    if (libraries.isEmpty()) {
      return;
    }
    DefaultMutableTreeNode rootNode=myTable.getRoot();
    for (    Library library : libraries) {
      String libraryId=((FlexLibraryProperties)((LibraryEx)library).getProperties()).getId();
      LibraryOrderEntry libraryEntry=myModifiableRootModel.findLibraryOrderEntry(library);
      rootNode.add(new DefaultMutableTreeNode(new ModuleLibraryItem(libraryId,libraryEntry),false));
    }
    myTable.refresh();
    myTable.getSelectionModel().clearSelection();
    int rowCount=myTable.getRowCount();
    myTable.getSelectionModel().addSelectionInterval(rowCount - libraries.size(),rowCount - 1);
  }
  finally {
    Disposer.dispose(c);
  }
}
