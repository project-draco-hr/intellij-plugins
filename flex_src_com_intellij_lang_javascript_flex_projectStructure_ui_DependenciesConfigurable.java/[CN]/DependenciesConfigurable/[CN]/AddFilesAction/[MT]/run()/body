{
  final Collection<Library> usedLibraries=new ArrayList<Library>();
  List<MyTableItem> items=myTable.getItems();
  for (  MyTableItem item : items) {
    if (item instanceof ModuleLibraryItem) {
      LibraryOrderEntry orderEntry=((ModuleLibraryItem)item).orderEntry;
      if (orderEntry != null) {
        Library library=orderEntry.getLibrary();
        if (library != null) {
          usedLibraries.add(orderEntry.getLibrary());
        }
      }
    }
  }
  Condition<Library> filter=new Condition<Library>(){
    @Override public boolean value(    Library library){
      return usedLibraries.contains(library);
    }
  }
;
  LibraryTableBase.ModifiableModelEx modifiableModel=myConfigEditor.getLibraryModel(myDependencies);
  LibraryTable.ModifiableModel librariesModelWrapper=new LibraryTableModifiableModelWrapper(modifiableModel,filter);
  Module module=myConfigEditor.getModule(myDependencies);
  List<? extends FlexLibraryType> libraryTypes=Collections.singletonList(new FlexLibraryType(){
    @Override @NotNull public LibraryRootsComponentDescriptor createLibraryRootsComponentDescriptor(){
      return new FlexLibraryRootsComponentDescriptor(){
        @NotNull @Override public List<? extends RootDetector> getRootDetectors(){
          return Arrays.asList(SWC_LIBRARY_DETECTOR);
        }
      }
;
    }
    @NotNull @Override public FlexLibraryProperties createDefaultProperties(){
      return new FlexLibraryProperties(FlexLibraryIdGenerator.generateId());
    }
  }
);
  CreateModuleLibraryChooser c=new CreateModuleLibraryChooser(libraryTypes,myMainPanel,module,librariesModelWrapper);
  final List<Library> libraries=c.chooseElements();
  if (libraries.isEmpty()) {
    return;
  }
  DefaultMutableTreeNode rootNode=myTable.getRoot();
  for (  Library library : libraries) {
    String libraryId=FlexProjectRootsUtil.getLibraryId(library);
    LibraryOrderEntry libraryEntry=myConfigEditor.findLibraryOrderEntry(myDependencies,library);
    rootNode.add(new DefaultMutableTreeNode(new ModuleLibraryItem(libraryId,libraryEntry,myProject),false));
  }
  updateTableOnItemsAdded(libraries.size());
}
