{
  ui.getOptions().setMinimizeActionEnabled(false);
  final Content consoleContent=ui.createContent(ExecutionConsole.CONSOLE_CONTENT_ID,getComponent(),"Test Run",AllIcons.Debugger.Console,getPreferredFocusableComponent());
  ui.addContent(consoleContent,1,PlaceInGrid.bottom,false);
  consoleContent.setCloseable(false);
  final KarmaRootTestProxyFormatter rootFormatter=new KarmaRootTestProxyFormatter(this,myServer,myExecutionSession.isDebug());
  if (myServer.areBrowsersReady()) {
    KarmaUtil.selectAndFocusIfNotDisposed(ui,consoleContent,false,false);
  }
 else {
    myServer.onPortBound(new Runnable(){
      @Override public void run(){
        KarmaUtil.selectAndFocusIfNotDisposed(ui,consoleContent,false,false);
        scheduleBrowserCapturingSuggestion();
      }
    }
);
  }
  final ProcessAdapter listener=new ProcessAdapter(){
    @Override public void processTerminated(    ProcessEvent event){
      if (myServer.getProcessHandler().isProcessTerminated()) {
        rootFormatter.onServerProcessTerminated();
        printServerFinishedInfo();
      }
      rootFormatter.onTestRunProcessTerminated();
    }
  }
;
  myExecutionSession.getProcessHandler().addProcessListener(listener);
  Disposer.register(this,new Disposable(){
    @Override public void dispose(){
      myExecutionSession.getProcessHandler().removeProcessListener(listener);
    }
  }
);
  return consoleContent;
}
