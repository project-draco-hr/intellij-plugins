{
  final TemporaryPlacesRegistry registry=TemporaryPlacesRegistry.getInstance(element.getProject());
  final InjectedLanguage language=registry.getLanguageFor(element,element.getContainingFile());
  if (language != null) {
    return language.getLanguage();
  }
  final PsiElement fenceLangElement=element.findPsiChildByType(MarkdownTokenTypes.FENCE_LANG);
  if (fenceLangElement == null) {
    return null;
  }
  return guessLanguageByFenceLang(fenceLangElement.getText());
}
