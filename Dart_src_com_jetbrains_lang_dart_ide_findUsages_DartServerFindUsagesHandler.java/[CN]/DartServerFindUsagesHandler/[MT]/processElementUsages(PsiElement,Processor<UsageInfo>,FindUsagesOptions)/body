{
  final ReadActionConsumer<SearchResult> searchResultProcessor=new ReadActionConsumer<SearchResult>(){
    @Override public void consumeInReadAction(    SearchResult result){
      final Location location=result.getLocation();
      final PsiElement locationPsiElement=findPsiElement(element,location);
      if (locationPsiElement != null) {
        int offset=location.getOffset();
        int length=location.getLength();
        offset-=locationPsiElement.getTextOffset();
        processor.process(new UsageInfo(locationPsiElement,offset,offset + length));
      }
    }
  }
;
  final String elementFilePath=readEnclosingFilePath(element);
  final int elementOffset=element.getTextOffset();
  DartAnalysisServerService.getInstance().search_findElementReferences(elementFilePath,elementOffset,searchResultProcessor);
  return true;
}
