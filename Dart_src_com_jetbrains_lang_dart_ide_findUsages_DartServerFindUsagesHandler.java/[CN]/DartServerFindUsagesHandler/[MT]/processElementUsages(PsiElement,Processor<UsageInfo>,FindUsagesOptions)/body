{
  final ReadActionConsumer<SearchResult> searchResultProcessor=new ReadActionConsumer<SearchResult>(){
    @Override public void consumeInReadAction(    SearchResult result){
      final Location location=result.getLocation();
      final PsiElement locationPsiElement=findPsiElement(element,location);
      if (locationPsiElement != null) {
        int offset=location.getOffset();
        int length=location.getLength();
        offset-=locationPsiElement.getTextOffset();
        final UsageInfo usageInfo=new UsageInfo(locationPsiElement,offset,offset + length);
        usageInfo.setDynamicUsage(result.isPotential());
        processor.process(usageInfo);
      }
    }
  }
;
  final DartElementLocation elementLocation=DartElementLocation.of(element);
  DartAnalysisServerService.getInstance().search_findElementReferences(elementLocation.file,elementLocation.offset,searchResultProcessor);
  return true;
}
