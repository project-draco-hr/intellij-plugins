{
  try {
    ReportingBuilder builder=new ReportingBuilder(mySession,bndFile);
    builder.setPedantic(false);
    builder.setProperties(bndFile);
    File[] classPath={mySession.getModuleOutputDir()};
    builder.setClasspath(classPath);
    String manifest=builder.getProperty(aQute.bnd.osgi.Constants.MANIFEST);
    if (manifest != null) {
      File manifestFile=builder.getFile(manifest);
      if (manifestFile != null && manifestFile.canRead()) {
        Properties props=new Properties();
        FileInputStream fileInputStream=new FileInputStream(manifestFile);
        try {
          props.load(fileInputStream);
          String value=props.getProperty(Attributes.Name.MANIFEST_VERSION.toString());
          if (StringUtil.isEmptyOrSpaces(value)) {
            String message="Your manifest does not contain a Manifest-Version entry. This may produce an empty manifest in the resulting bundle.";
            mySession.warn(message,manifest);
          }
        }
 catch (        Exception ex) {
          mySession.warn("There was a problem reading your manifest.",manifest);
        }
 finally {
          fileInputStream.close();
        }
      }
    }
    Jar jar=builder.build();
    jar.setName(outputFile.getName());
    jar.write(outputFile);
    builder.close();
  }
 catch (  Exception e) {
    throw new OsmorcBuildException("Unexpected build error",e);
  }
}
