{
  new WriteCommandAction.Simple(null){
    public void run() throws ConfigurationException {
      modifyConfigs(dependency.getProject(),new Consumer<FlexProjectConfigurationEditor>(){
        @Override public void consume(        final FlexProjectConfigurationEditor editor){
          final ModifiableFlexBuildConfiguration dependentBc=editor.getConfigurations(dependent)[0];
          final ModifiableFlexBuildConfiguration dependencyBc=editor.getConfigurations(dependency)[0];
          dependencyBc.setOutputType(OutputType.Library);
          final ModifiableBuildConfigurationEntry dependencyEntry=editor.createBcEntry(dependentBc.getDependencies(),dependencyBc,null);
          dependentBc.getDependencies().getModifiableEntries().add(dependencyEntry);
        }
      }
);
    }
  }
.execute().throwException();
}
