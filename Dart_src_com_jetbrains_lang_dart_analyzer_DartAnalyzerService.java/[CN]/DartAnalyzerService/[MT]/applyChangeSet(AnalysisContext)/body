{
  final ChangeSet changeSet=new ChangeSet();
  for (  final Source source : context.getLibrarySources()) {
    if (source instanceof DartFileBasedSource) {
      if (!source.exists() || !myFileToSourceMap.containsKey(((DartFileBasedSource)source).getFile())) {
        changeSet.removed(source);
        continue;
      }
      if (((DartFileBasedSource)source).isOutOfDate()) {
        changeSet.changed(source);
      }
    }
  }
synchronized (myCreatedFiles) {
    for (    VirtualFile file : myCreatedFiles) {
      changeSet.added(DartFileBasedSource.getSource(myProject,file));
    }
  }
  context.applyChanges(changeSet);
}
