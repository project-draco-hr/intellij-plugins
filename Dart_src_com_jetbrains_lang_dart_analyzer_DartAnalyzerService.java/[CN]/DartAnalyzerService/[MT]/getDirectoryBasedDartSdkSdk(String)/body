{
  final File sdkDir=new File(sdkPath);
  if (ourDirectoryBasedDartSdk == null || !FileUtil.filesEqual(sdkDir,ourDirectoryBasedDartSdk.getDirectory())) {
    AnalysisEngine.getInstance().clearCaches();
    if (myAnalysisContextRef != null) {
      myAnalysisContextRef.clear();
    }
    ourDirectoryBasedDartSdk=new DirectoryBasedDartSdk(sdkDir);
  }
  return ourDirectoryBasedDartSdk;
}
